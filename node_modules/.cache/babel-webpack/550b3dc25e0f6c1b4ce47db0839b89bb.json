{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/overlay/ui.overlay.js)\r\n * Version: 21.2.15\r\n * Build date: Fri Dec 08 2023\r\n *\r\n * Copyright (c) 2012 - 2023 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport { getOuterWidth, getOuterHeight, getWidth, getHeight } from \"../../core/utils/size\";\nimport fx from \"../../animation/fx\";\nimport registerComponent from \"../../core/component_registrator\";\nimport devices from \"../../core/devices\";\nimport domAdapter from \"../../core/dom_adapter\";\nimport { getPublicElement } from \"../../core/element\";\nimport $ from \"../../core/renderer\";\nimport { EmptyTemplate } from \"../../core/templates/empty_template\";\nimport { inArray } from \"../../core/utils/array\";\nimport { noop } from \"../../core/utils/common\";\nimport { Deferred } from \"../../core/utils/deferred\";\nimport { contains, resetActiveElement } from \"../../core/utils/dom\";\nimport { extend } from \"../../core/utils/extend\";\nimport { each } from \"../../core/utils/iterator\";\nimport readyCallbacks from \"../../core/utils/ready_callbacks\";\nimport { isDefined, isFunction, isPlainObject, isObject } from \"../../core/utils/type\";\nimport { changeCallback } from \"../../core/utils/view_port\";\nimport { getWindow, hasWindow } from \"../../core/utils/window\";\nimport errors from \"../../core/errors\";\nimport eventsEngine from \"../../events/core/events_engine\";\nimport { move as dragEventMove } from \"../../events/drag\";\nimport pointerEvents from \"../../events/pointer\";\nimport { keyboard } from \"../../events/short\";\nimport { addNamespace, isCommandKeyPressed, normalizeKeyName } from \"../../events/utils/index\";\nimport { triggerHidingEvent, triggerResizeEvent, triggerShownEvent } from \"../../events/visibility_change\";\nimport { hideCallback as hideTopOverlayCallback } from \"../../mobile/hide_callback\";\nimport Resizable from \"../resizable\";\nimport OverlayDrag from \"./overlay_drag\";\nimport { tabbable } from \"../widget/selectors\";\nimport swatch from \"../widget/swatch_container\";\nimport Widget from \"../widget/ui.widget\";\nimport browser from \"../../core/utils/browser\";\nimport * as zIndexPool from \"./z_index\";\nimport resizeObserverSingleton from \"../../core/resize_observer\";\nimport { OverlayPositionController, OVERLAY_POSITION_ALIASES } from \"./overlay_position_controller\";\nvar ready = readyCallbacks.add;\nvar window = getWindow();\nvar viewPortChanged = changeCallback;\nvar OVERLAY_CLASS = \"dx-overlay\";\nvar OVERLAY_WRAPPER_CLASS = \"dx-overlay-wrapper\";\nvar OVERLAY_CONTENT_CLASS = \"dx-overlay-content\";\nvar OVERLAY_SHADER_CLASS = \"dx-overlay-shader\";\nvar OVERLAY_MODAL_CLASS = \"dx-overlay-modal\";\nvar INNER_OVERLAY_CLASS = \"dx-inner-overlay\";\nvar INVISIBLE_STATE_CLASS = \"dx-state-invisible\";\nvar ANONYMOUS_TEMPLATE_NAME = \"content\";\nvar RTL_DIRECTION_CLASS = \"dx-rtl\";\nvar ACTIONS = [\"onShowing\", \"onShown\", \"onHiding\", \"onHidden\", \"onPositioned\", \"onResizeStart\", \"onResize\", \"onResizeEnd\", \"onVisualPositionChanged\"];\nvar OVERLAY_STACK = [];\nvar PREVENT_SAFARI_SCROLLING_CLASS = \"dx-prevent-safari-scrolling\";\nvar TAB_KEY = \"tab\";\nready(() => {\n  eventsEngine.subscribeGlobal(domAdapter.getDocument(), pointerEvents.down, e => {\n    for (var i = OVERLAY_STACK.length - 1; i >= 0; i--) {\n      if (!OVERLAY_STACK[i]._proxiedDocumentDownHandler(e)) {\n        return;\n      }\n    }\n  });\n});\nvar Overlay = Widget.inherit({\n  _supportedKeys: function () {\n    return extend(this.callBase(), {\n      escape: function () {\n        this.hide();\n      },\n      upArrow: e => {\n        var _this$_drag;\n\n        null === (_this$_drag = this._drag) || void 0 === _this$_drag ? void 0 : _this$_drag.moveUp(e);\n      },\n      downArrow: e => {\n        var _this$_drag2;\n\n        null === (_this$_drag2 = this._drag) || void 0 === _this$_drag2 ? void 0 : _this$_drag2.moveDown(e);\n      },\n      leftArrow: e => {\n        var _this$_drag3;\n\n        null === (_this$_drag3 = this._drag) || void 0 === _this$_drag3 ? void 0 : _this$_drag3.moveLeft(e);\n      },\n      rightArrow: e => {\n        var _this$_drag4;\n\n        null === (_this$_drag4 = this._drag) || void 0 === _this$_drag4 ? void 0 : _this$_drag4.moveRight(e);\n      }\n    });\n  },\n  _getDefaultOptions: function () {\n    return extend(this.callBase(), {\n      activeStateEnabled: false,\n      visible: false,\n      deferRendering: true,\n      shading: true,\n      shadingColor: \"\",\n      wrapperAttr: {},\n      position: extend({}, OVERLAY_POSITION_ALIASES.center),\n      width: \"80vw\",\n      minWidth: null,\n      maxWidth: null,\n      height: \"80vh\",\n      minHeight: null,\n      maxHeight: null,\n      animation: {\n        show: {\n          type: \"pop\",\n          duration: 300,\n          from: {\n            scale: .55\n          }\n        },\n        hide: {\n          type: \"pop\",\n          duration: 300,\n          from: {\n            opacity: 1,\n            scale: 1\n          },\n          to: {\n            opacity: 0,\n            scale: .55\n          }\n        }\n      },\n      dragOutsideBoundary: false,\n      closeOnOutsideClick: false,\n      copyRootClassesToWrapper: false,\n      _ignoreCopyRootClassesToWrapperDeprecation: false,\n      _ignoreElementAttrDeprecation: false,\n      onShowing: null,\n      onShown: null,\n      onHiding: null,\n      onHidden: null,\n      contentTemplate: \"content\",\n      dragEnabled: false,\n      dragAndResizeArea: void 0,\n      outsideDragFactor: 0,\n      resizeEnabled: false,\n      onResizeStart: null,\n      onResize: null,\n      onResizeEnd: null,\n      innerOverlay: false,\n      restorePosition: true,\n      target: void 0,\n      container: void 0,\n      hideTopOverlayHandler: () => {\n        this.hide();\n      },\n      hideOnParentScroll: false,\n      onPositioned: null,\n      propagateOutsideClick: false,\n      ignoreChildEvents: true,\n      _checkParentVisibility: true,\n      _fixWrapperPosition: false\n    });\n  },\n  _defaultOptionsRules: function () {\n    return this.callBase().concat([{\n      device: function () {\n        return !hasWindow();\n      },\n      options: {\n        width: null,\n        height: null,\n        animation: null,\n        _checkParentVisibility: false\n      }\n    }]);\n  },\n  _setOptionsByReference: function () {\n    this.callBase();\n    extend(this._optionsByReference, {\n      animation: true\n    });\n  },\n  $wrapper: function () {\n    return this._$wrapper;\n  },\n  _eventBindingTarget: function () {\n    return this._$content;\n  },\n  ctor: function (element, options) {\n    this.callBase(element, options);\n\n    if (options) {\n      if (options.copyRootClassesToWrapper && !options._ignoreCopyRootClassesToWrapperDeprecation) {\n        this._logDeprecatedOptionWarning(\"copyRootClassesToWrapper\", {\n          since: \"21.2\",\n          message: 'Use the \"wrapperAttr\" option instead'\n        });\n      }\n\n      if (options.elementAttr && !options._ignoreElementAttrDeprecation) {\n        this._logDeprecatedOptionWarning(\"elementAttr\", {\n          since: \"21.2\",\n          message: 'Use the \"wrapperAttr\" option instead'\n        });\n      }\n    }\n  },\n  _init: function () {\n    this.callBase();\n\n    this._initActions();\n\n    this._initCloseOnOutsideClickHandler();\n\n    this._initTabTerminatorHandler();\n\n    this._customWrapperClass = null;\n    this._$wrapper = $(\"<div>\").addClass(OVERLAY_WRAPPER_CLASS);\n    this._$content = $(\"<div>\").addClass(OVERLAY_CONTENT_CLASS);\n\n    this._initInnerOverlayClass();\n\n    var $element = this.$element();\n\n    if (this.option(\"copyRootClassesToWrapper\")) {\n      this._$wrapper.addClass($element.attr(\"class\"));\n    }\n\n    $element.addClass(OVERLAY_CLASS);\n\n    this._$wrapper.attr(\"data-bind\", \"dxControlsDescendantBindings: true\");\n\n    this._toggleViewPortSubscription(true);\n\n    this._initHideTopOverlayHandler(this.option(\"hideTopOverlayHandler\"));\n\n    this._parentsScrollSubscriptionInfo = {\n      handler: e => {\n        this._hideOnParentsScrollHandler(e);\n      }\n    };\n\n    this._updateResizeCallbackSkipCondition();\n\n    this.warnPositionAsFunction();\n  },\n\n  warnPositionAsFunction() {\n    if (isFunction(this.option(\"position\"))) {\n      errors.log(\"W0018\");\n    }\n  },\n\n  _initOptions: function (options) {\n    this._setAnimationTarget(options.target);\n\n    this.callBase(options);\n  },\n  _initInnerOverlayClass: function () {\n    this._$content.toggleClass(INNER_OVERLAY_CLASS, this.option(\"innerOverlay\"));\n  },\n  _setAnimationTarget: function (target) {\n    if (!isDefined(target)) {\n      return;\n    }\n\n    var options = this.option();\n    [\"animation.show.from.position.of\", \"animation.show.to.position.of\", \"animation.hide.from.position.of\", \"animation.hide.to.position.of\"].forEach(path => {\n      var pathParts = path.split(\".\");\n      var option = options;\n\n      while (option) {\n        if (1 === pathParts.length) {\n          if (isPlainObject(option)) {\n            option[pathParts.shift()] = target;\n          }\n\n          break;\n        } else {\n          option = option[pathParts.shift()];\n        }\n      }\n    });\n  },\n  _initHideTopOverlayHandler: function (handler) {\n    this._hideTopOverlayHandler = handler;\n  },\n  _initActions: function () {\n    this._actions = {};\n    each(ACTIONS, (_, action) => {\n      this._actions[action] = this._createActionByOption(action, {\n        excludeValidators: [\"disabled\", \"readOnly\"]\n      }) || noop;\n    });\n  },\n  _initCloseOnOutsideClickHandler: function () {\n    var _this = this;\n\n    this._proxiedDocumentDownHandler = function () {\n      return _this._documentDownHandler(...arguments);\n    };\n  },\n  _areContentDimensionsRendered: function (entry) {\n    var _entry$contentBoxSize, _this$_renderedDimens3, _this$_renderedDimens4;\n\n    var contentBox = null === (_entry$contentBoxSize = entry.contentBoxSize) || void 0 === _entry$contentBoxSize ? void 0 : _entry$contentBoxSize[0];\n\n    if (contentBox) {\n      var _this$_renderedDimens, _this$_renderedDimens2;\n\n      return parseInt(contentBox.inlineSize, 10) === (null === (_this$_renderedDimens = this._renderedDimensions) || void 0 === _this$_renderedDimens ? void 0 : _this$_renderedDimens.width) && parseInt(contentBox.blockSize, 10) === (null === (_this$_renderedDimens2 = this._renderedDimensions) || void 0 === _this$_renderedDimens2 ? void 0 : _this$_renderedDimens2.height);\n    }\n\n    var contentRect = entry.contentRect;\n    return parseInt(contentRect.width, 10) === (null === (_this$_renderedDimens3 = this._renderedDimensions) || void 0 === _this$_renderedDimens3 ? void 0 : _this$_renderedDimens3.width) && parseInt(contentRect.height, 10) === (null === (_this$_renderedDimens4 = this._renderedDimensions) || void 0 === _this$_renderedDimens4 ? void 0 : _this$_renderedDimens4.height);\n  },\n  _contentResizeHandler: function (entry) {\n    if (!this._shouldSkipContentResize(entry) && this._$content.is(\":visible\")) {\n      this._renderGeometry({\n        shouldOnlyReposition: true\n      });\n    }\n  },\n\n  _updateResizeCallbackSkipCondition() {\n    var doesShowAnimationChangeDimensions = this._doesShowAnimationChangeDimensions();\n\n    this._shouldSkipContentResize = entry => doesShowAnimationChangeDimensions && this._showAnimationProcessing || this._areContentDimensionsRendered(entry);\n  },\n\n  _doesShowAnimationChangeDimensions: function () {\n    var animation = this.option(\"animation\");\n    return [\"to\", \"from\"].some(prop => {\n      var _animation$show;\n\n      var config = null === animation || void 0 === animation ? void 0 : null === (_animation$show = animation.show) || void 0 === _animation$show ? void 0 : _animation$show[prop];\n      return isObject(config) && (\"width\" in config || \"height\" in config);\n    });\n  },\n  _observeContentResize: function (shouldObserve) {\n    if (!this.option(\"useResizeObserver\")) {\n      return;\n    }\n\n    var contentElement = this._$content.get(0);\n\n    if (shouldObserve) {\n      resizeObserverSingleton.observe(contentElement, entry => {\n        this._contentResizeHandler(entry);\n      });\n    } else {\n      resizeObserverSingleton.unobserve(contentElement);\n    }\n  },\n\n  _initMarkup() {\n    this.callBase();\n\n    this._renderWrapperAttributes();\n\n    this._initPositionController();\n  },\n\n  _documentDownHandler: function (e) {\n    if (this._showAnimationProcessing) {\n      this._stopAnimation();\n    }\n\n    var closeOnOutsideClick = this.option(\"closeOnOutsideClick\");\n\n    if (isFunction(closeOnOutsideClick)) {\n      closeOnOutsideClick = closeOnOutsideClick(e);\n    }\n\n    var isAttachedTarget = $(window.document).is(e.target) || contains(window.document, e.target);\n    var isInnerOverlay = $(e.target).closest(\".\".concat(INNER_OVERLAY_CLASS)).length;\n    var outsideClick = isAttachedTarget && !isInnerOverlay && !(this._$content.is(e.target) || contains(this._$content.get(0), e.target));\n\n    if (outsideClick && closeOnOutsideClick) {\n      this._outsideClickHandler(e);\n    }\n\n    return this.option(\"propagateOutsideClick\");\n  },\n\n  _outsideClickHandler(e) {\n    if (this.option(\"shading\")) {\n      e.preventDefault();\n    }\n\n    this.hide();\n  },\n\n  _getAnonymousTemplateName: function () {\n    return ANONYMOUS_TEMPLATE_NAME;\n  },\n  _initTemplates: function () {\n    this._templateManager.addDefaultTemplates({\n      content: new EmptyTemplate()\n    });\n\n    this.callBase();\n  },\n  _isTopOverlay: function () {\n    var overlayStack = this._overlayStack();\n\n    for (var i = overlayStack.length - 1; i >= 0; i--) {\n      var tabbableElements = overlayStack[i]._findTabbableBounds();\n\n      if (tabbableElements.first || tabbableElements.last) {\n        return overlayStack[i] === this;\n      }\n    }\n\n    return false;\n  },\n  _overlayStack: function () {\n    return OVERLAY_STACK;\n  },\n  _zIndexInitValue: function () {\n    return Overlay.baseZIndex();\n  },\n  _toggleViewPortSubscription: function (toggle) {\n    var _this2 = this;\n\n    viewPortChanged.remove(this._viewPortChangeHandle);\n\n    if (toggle) {\n      this._viewPortChangeHandle = function () {\n        _this2._viewPortChangeHandler(...arguments);\n      };\n\n      viewPortChanged.add(this._viewPortChangeHandle);\n    }\n  },\n  _viewPortChangeHandler: function () {\n    this._positionController.updateContainer(this.option(\"container\"));\n\n    this._refresh();\n  },\n\n  _renderWrapperAttributes() {\n    var {\n      wrapperAttr: wrapperAttr\n    } = this.option();\n    var attributes = extend({}, wrapperAttr);\n    var classNames = attributes.class;\n    delete attributes.class;\n    this.$wrapper().attr(attributes).removeClass(this._customWrapperClass).addClass(classNames);\n    this._customWrapperClass = classNames;\n  },\n\n  _renderVisibilityAnimate: function (visible) {\n    this._observeContentResize(visible);\n\n    this._stopAnimation();\n\n    return visible ? this._show() : this._hide();\n  },\n  _getAnimationConfig: function () {\n    return this._getOptionValue(\"animation\", this);\n  },\n  _animateShowing: function () {\n    var _this$_getAnimationCo,\n        _showAnimation$start,\n        _showAnimation$comple,\n        _this3 = this;\n\n    var animation = null !== (_this$_getAnimationCo = this._getAnimationConfig()) && void 0 !== _this$_getAnimationCo ? _this$_getAnimationCo : {};\n\n    var showAnimation = this._normalizeAnimation(animation.show, \"to\");\n\n    var startShowAnimation = null !== (_showAnimation$start = null === showAnimation || void 0 === showAnimation ? void 0 : showAnimation.start) && void 0 !== _showAnimation$start ? _showAnimation$start : noop;\n    var completeShowAnimation = null !== (_showAnimation$comple = null === showAnimation || void 0 === showAnimation ? void 0 : showAnimation.complete) && void 0 !== _showAnimation$comple ? _showAnimation$comple : noop;\n\n    this._animate(showAnimation, function () {\n      if (_this3._isAnimationPaused) {\n        return;\n      }\n\n      if (_this3.option(\"focusStateEnabled\")) {\n        eventsEngine.trigger(_this3._focusTarget(), \"focus\");\n      }\n\n      for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n        args[_key] = arguments[_key];\n      }\n\n      completeShowAnimation.call(_this3, ...args);\n      _this3._showAnimationProcessing = false;\n      _this3._isHidden = false;\n\n      _this3._actions.onShown();\n\n      _this3._toggleSafariScrolling();\n\n      _this3._showingDeferred.resolve();\n    }, function () {\n      if (_this3._isAnimationPaused) {\n        return;\n      }\n\n      for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\n        args[_key2] = arguments[_key2];\n      }\n\n      startShowAnimation.call(_this3, ...args);\n      _this3._showAnimationProcessing = true;\n    });\n  },\n  _show: function () {\n    this._showingDeferred = new Deferred();\n    this._parentHidden = this._isParentHidden();\n\n    this._showingDeferred.done(() => {\n      delete this._parentHidden;\n    });\n\n    if (this._parentHidden) {\n      this._isHidden = true;\n      return this._showingDeferred.resolve();\n    }\n\n    if (this._currentVisible) {\n      return new Deferred().resolve().promise();\n    }\n\n    this._currentVisible = true;\n\n    if (this._isHidingActionCanceled) {\n      delete this._isHidingActionCanceled;\n\n      this._showingDeferred.resolve();\n    } else {\n      var show = () => {\n        this._stopAnimation();\n\n        this._toggleVisibility(true);\n\n        this._$content.css(\"visibility\", \"hidden\");\n\n        this._$content.toggleClass(INVISIBLE_STATE_CLASS, false);\n\n        this._updateZIndexStackPosition(true);\n\n        this._positionController.openingHandled();\n\n        this._renderContent();\n\n        var showingArgs = {\n          cancel: false\n        };\n\n        this._actions.onShowing(showingArgs);\n\n        if (showingArgs.cancel) {\n          (() => {\n            this._toggleVisibility(false);\n\n            this._$content.css(\"visibility\", \"\");\n\n            this._$content.toggleClass(INVISIBLE_STATE_CLASS, true);\n\n            this._isShowingActionCanceled = true;\n\n            this._moveFromContainer();\n\n            this.option(\"visible\", false);\n\n            this._showingDeferred.resolve();\n          })();\n        } else {\n          (() => {\n            this._$content.css(\"visibility\", \"\");\n\n            this._renderVisibility(true);\n\n            this._animateShowing();\n          })();\n        }\n      };\n\n      if (this.option(\"templatesRenderAsynchronously\")) {\n        this._stopShowTimer();\n\n        this._asyncShowTimeout = setTimeout(show);\n      } else {\n        show();\n      }\n    }\n\n    return this._showingDeferred.promise();\n  },\n  _normalizeAnimation: function (animation, prop) {\n    if (animation) {\n      animation = extend({\n        type: \"slide\",\n        skipElementInitialStyles: true\n      }, animation);\n\n      if (animation[prop] && \"object\" === typeof animation[prop]) {\n        extend(animation[prop], {\n          position: this._positionController._position\n        });\n      }\n    }\n\n    return animation;\n  },\n  _animateHiding: function () {\n    var _this$_getAnimationCo2,\n        _hideAnimation$start,\n        _hideAnimation$comple,\n        _this4 = this;\n\n    var animation = null !== (_this$_getAnimationCo2 = this._getAnimationConfig()) && void 0 !== _this$_getAnimationCo2 ? _this$_getAnimationCo2 : {};\n\n    var hideAnimation = this._normalizeAnimation(animation.hide, \"from\");\n\n    var startHideAnimation = null !== (_hideAnimation$start = null === hideAnimation || void 0 === hideAnimation ? void 0 : hideAnimation.start) && void 0 !== _hideAnimation$start ? _hideAnimation$start : noop;\n    var completeHideAnimation = null !== (_hideAnimation$comple = null === hideAnimation || void 0 === hideAnimation ? void 0 : hideAnimation.complete) && void 0 !== _hideAnimation$comple ? _hideAnimation$comple : noop;\n\n    this._animate(hideAnimation, function () {\n      var _this4$_actions;\n\n      _this4._$content.css(\"pointerEvents\", \"\");\n\n      _this4._renderVisibility(false);\n\n      for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\n        args[_key3] = arguments[_key3];\n      }\n\n      completeHideAnimation.call(_this4, ...args);\n      _this4._hideAnimationProcessing = false;\n      null === (_this4$_actions = _this4._actions) || void 0 === _this4$_actions ? void 0 : _this4$_actions.onHidden();\n\n      _this4._hidingDeferred.resolve();\n    }, function () {\n      _this4._$content.css(\"pointerEvents\", \"none\");\n\n      for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\n        args[_key4] = arguments[_key4];\n      }\n\n      startHideAnimation.call(_this4, ...args);\n      _this4._hideAnimationProcessing = true;\n    });\n  },\n  _hide: function () {\n    if (!this._currentVisible) {\n      return new Deferred().resolve().promise();\n    }\n\n    this._currentVisible = false;\n    this._hidingDeferred = new Deferred();\n    var hidingArgs = {\n      cancel: false\n    };\n\n    if (this._isShowingActionCanceled) {\n      delete this._isShowingActionCanceled;\n\n      this._hidingDeferred.resolve();\n    } else {\n      this._actions.onHiding(hidingArgs);\n\n      this._toggleSafariScrolling();\n\n      if (hidingArgs.cancel) {\n        (() => {\n          this._isHidingActionCanceled = true;\n          this.option(\"visible\", true);\n\n          this._hidingDeferred.resolve();\n        })();\n      } else {\n        (() => {\n          this._forceFocusLost();\n\n          this._toggleShading(false);\n\n          this._toggleSubscriptions(false);\n\n          this._stopShowTimer();\n\n          this._animateHiding();\n        })();\n      }\n    }\n\n    return this._hidingDeferred.promise();\n  },\n  _forceFocusLost: function () {\n    var activeElement = domAdapter.getActiveElement();\n    var shouldResetActiveElement = !!this._$content.find(activeElement).length;\n\n    if (shouldResetActiveElement) {\n      resetActiveElement();\n    }\n  },\n  _animate: function (animation, completeCallback, startCallback) {\n    if (animation) {\n      startCallback = startCallback || animation.start || noop;\n      fx.animate(this._$content, extend({}, animation, {\n        start: startCallback,\n        complete: completeCallback\n      }));\n    } else {\n      completeCallback();\n    }\n  },\n  _stopAnimation: function () {\n    fx.stop(this._$content, true);\n  },\n  _renderVisibility: function (visible) {\n    if (visible && this._isParentHidden()) {\n      return;\n    }\n\n    this._currentVisible = visible;\n\n    this._stopAnimation();\n\n    if (!visible) {\n      triggerHidingEvent(this._$content);\n    }\n\n    if (visible) {\n      this._moveToContainer();\n\n      this._renderGeometry();\n\n      triggerShownEvent(this._$content);\n      triggerResizeEvent(this._$content);\n    } else {\n      this._toggleVisibility(visible);\n\n      this._$content.toggleClass(INVISIBLE_STATE_CLASS, !visible);\n\n      this._updateZIndexStackPosition(visible);\n\n      this._moveFromContainer();\n    }\n\n    this._toggleShading(visible);\n\n    this._toggleSubscriptions(visible);\n  },\n  _updateZIndexStackPosition: function (pushToStack) {\n    var overlayStack = this._overlayStack();\n\n    var index = inArray(this, overlayStack);\n\n    if (pushToStack) {\n      if (-1 === index) {\n        this._zIndex = zIndexPool.create(this._zIndexInitValue());\n        overlayStack.push(this);\n      }\n\n      this._$wrapper.css(\"zIndex\", this._zIndex);\n\n      this._$content.css(\"zIndex\", this._zIndex);\n    } else if (-1 !== index) {\n      overlayStack.splice(index, 1);\n      zIndexPool.remove(this._zIndex);\n    }\n  },\n  _toggleShading: function (visible) {\n    this._$wrapper.toggleClass(OVERLAY_MODAL_CLASS, this.option(\"shading\") && !this.option(\"container\"));\n\n    this._$wrapper.toggleClass(OVERLAY_SHADER_CLASS, visible && this.option(\"shading\"));\n\n    this._$wrapper.css(\"backgroundColor\", this.option(\"shading\") ? this.option(\"shadingColor\") : \"\");\n\n    this._toggleTabTerminator(visible && this.option(\"shading\"));\n  },\n  _initTabTerminatorHandler: function () {\n    var _this5 = this;\n\n    this._proxiedTabTerminatorHandler = function () {\n      _this5._tabKeyHandler(...arguments);\n    };\n  },\n  _toggleTabTerminator: function (enabled) {\n    var eventName = addNamespace(\"keydown\", this.NAME);\n\n    if (enabled) {\n      eventsEngine.on(domAdapter.getDocument(), eventName, this._proxiedTabTerminatorHandler);\n    } else {\n      eventsEngine.off(domAdapter.getDocument(), eventName, this._proxiedTabTerminatorHandler);\n    }\n  },\n  _findTabbableBounds: function () {\n    var $elements = this._$wrapper.find(\"*\");\n\n    var elementsCount = $elements.length - 1;\n    var result = {\n      first: null,\n      last: null\n    };\n\n    for (var i = 0; i <= elementsCount; i++) {\n      if (!result.first && $elements.eq(i).is(tabbable)) {\n        result.first = $elements.eq(i);\n      }\n\n      if (!result.last && $elements.eq(elementsCount - i).is(tabbable)) {\n        result.last = $elements.eq(elementsCount - i);\n      }\n\n      if (result.first && result.last) {\n        break;\n      }\n    }\n\n    return result;\n  },\n  _tabKeyHandler: function (e) {\n    if (normalizeKeyName(e) !== TAB_KEY || !this._isTopOverlay()) {\n      return;\n    }\n\n    var tabbableElements = this._findTabbableBounds();\n\n    var $firstTabbable = tabbableElements.first;\n    var $lastTabbable = tabbableElements.last;\n    var isTabOnLast = !e.shiftKey && e.target === $lastTabbable.get(0);\n    var isShiftTabOnFirst = e.shiftKey && e.target === $firstTabbable.get(0);\n    var isEmptyTabList = 0 === tabbableElements.length;\n    var isOutsideTarget = !contains(this._$wrapper.get(0), e.target);\n\n    if (isTabOnLast || isShiftTabOnFirst || isEmptyTabList || isOutsideTarget) {\n      e.preventDefault();\n      var $focusElement = e.shiftKey ? $lastTabbable : $firstTabbable;\n      eventsEngine.trigger($focusElement, \"focusin\");\n      eventsEngine.trigger($focusElement, \"focus\");\n    }\n  },\n  _toggleSubscriptions: function (enabled) {\n    if (hasWindow()) {\n      this._toggleHideTopOverlayCallback(enabled);\n\n      this._toggleHideOnParentsScrollSubscription(enabled);\n    }\n  },\n  _toggleHideTopOverlayCallback: function (subscribe) {\n    if (!this._hideTopOverlayHandler) {\n      return;\n    }\n\n    if (subscribe) {\n      hideTopOverlayCallback.add(this._hideTopOverlayHandler);\n    } else {\n      hideTopOverlayCallback.remove(this._hideTopOverlayHandler);\n    }\n  },\n  _toggleHideOnParentsScrollSubscription: function (needSubscribe) {\n    var _this$_parentsScrollS;\n\n    var scrollEvent = addNamespace(\"scroll\", this.NAME);\n    var {\n      prevTargets: prevTargets,\n      handler: handler\n    } = null !== (_this$_parentsScrollS = this._parentsScrollSubscriptionInfo) && void 0 !== _this$_parentsScrollS ? _this$_parentsScrollS : {};\n    eventsEngine.off(prevTargets, scrollEvent, handler);\n    var closeOnScroll = this.option(\"hideOnParentScroll\");\n\n    if (needSubscribe && closeOnScroll) {\n      var $parents = this._hideOnParentScrollTarget().parents();\n\n      if (\"desktop\" === devices.real().deviceType) {\n        $parents = $parents.add(window);\n      }\n\n      eventsEngine.on($parents, scrollEvent, handler);\n      this._parentsScrollSubscriptionInfo.prevTargets = $parents;\n    }\n  },\n  _hideOnParentsScrollHandler: function (e) {\n    var closeHandled = false;\n    var closeOnScroll = this.option(\"hideOnParentScroll\");\n\n    if (isFunction(closeOnScroll)) {\n      closeHandled = closeOnScroll(e);\n    }\n\n    if (!closeHandled && !this._showAnimationProcessing) {\n      this.hide();\n    }\n  },\n  _hideOnParentScrollTarget: function () {\n    return this._$wrapper;\n  },\n  _render: function () {\n    this.callBase();\n\n    this._appendContentToElement();\n\n    this._renderVisibilityAnimate(this.option(\"visible\"));\n  },\n  _appendContentToElement: function () {\n    if (!this._$content.parent().is(this.$element())) {\n      this._$content.appendTo(this.$element());\n    }\n  },\n  _renderContent: function () {\n    var shouldDeferRendering = !this._currentVisible && this.option(\"deferRendering\");\n\n    var isParentHidden = this.option(\"visible\") && this._isParentHidden();\n\n    if (isParentHidden) {\n      this._isHidden = true;\n      return;\n    }\n\n    if (this._contentAlreadyRendered || shouldDeferRendering) {\n      return;\n    }\n\n    this._contentAlreadyRendered = true;\n\n    this._appendContentToElement();\n\n    this.callBase();\n  },\n  _isParentHidden: function () {\n    if (!this.option(\"_checkParentVisibility\")) {\n      return false;\n    }\n\n    if (void 0 !== this._parentHidden) {\n      return this._parentHidden;\n    }\n\n    var $parent = this.$element().parent();\n\n    if ($parent.is(\":visible\")) {\n      return false;\n    }\n\n    var isHidden = false;\n    $parent.add($parent.parents()).each(function () {\n      var $element = $(this);\n\n      if (\"none\" === $element.css(\"display\")) {\n        isHidden = true;\n        return false;\n      }\n    });\n    return isHidden || !domAdapter.getBody().contains($parent.get(0));\n  },\n  _renderContentImpl: function () {\n    var whenContentRendered = new Deferred();\n    var contentTemplateOption = this.option(\"contentTemplate\");\n\n    var contentTemplate = this._getTemplate(contentTemplateOption);\n\n    var transclude = this._templateManager.anonymousTemplateName === contentTemplateOption;\n    contentTemplate && contentTemplate.render({\n      container: getPublicElement(this.$content()),\n      noModel: true,\n      transclude: transclude,\n      onRendered: () => {\n        whenContentRendered.resolve();\n\n        if (this.option(\"templatesRenderAsynchronously\")) {\n          this._dimensionChanged();\n        }\n      }\n    });\n\n    this._renderDrag();\n\n    this._renderResize();\n\n    this._renderScrollTerminator();\n\n    whenContentRendered.done(() => {\n      if (this.option(\"visible\")) {\n        this._moveToContainer();\n      }\n    });\n    return whenContentRendered.promise();\n  },\n\n  _getPositionControllerConfig() {\n    var {\n      target: target,\n      container: container,\n      dragAndResizeArea: dragAndResizeArea,\n      dragOutsideBoundary: dragOutsideBoundary,\n      outsideDragFactor: outsideDragFactor,\n      _fixWrapperPosition: _fixWrapperPosition,\n      restorePosition: restorePosition\n    } = this.option();\n    return {\n      target: target,\n      container: container,\n      $root: this.$element(),\n      $content: this._$content,\n      $wrapper: this._$wrapper,\n      onPositioned: this._actions.onPositioned,\n      onVisualPositionChanged: this._actions.onVisualPositionChanged,\n      restorePosition: restorePosition,\n      dragAndResizeArea: dragAndResizeArea,\n      dragOutsideBoundary: dragOutsideBoundary,\n      outsideDragFactor: outsideDragFactor,\n      _fixWrapperPosition: _fixWrapperPosition\n    };\n  },\n\n  _initPositionController() {\n    this._positionController = new OverlayPositionController(this._getPositionControllerConfig());\n  },\n\n  _renderDrag: function () {\n    var $dragTarget = this._getDragTarget();\n\n    if (!$dragTarget) {\n      return;\n    }\n\n    var config = {\n      dragEnabled: this.option(\"dragEnabled\"),\n      handle: $dragTarget.get(0),\n      draggableElement: this._$content.get(0),\n      positionController: this._positionController\n    };\n\n    if (this._drag) {\n      this._drag.init(config);\n    } else {\n      this._drag = new OverlayDrag(config);\n    }\n  },\n  _renderResize: function () {\n    this._resizable = this._createComponent(this._$content, Resizable, {\n      handles: this.option(\"resizeEnabled\") ? \"all\" : \"none\",\n      onResizeEnd: e => {\n        this._resizeEndHandler(e);\n\n        this._observeContentResize(true);\n      },\n      onResize: e => {\n        this._actions.onResize(e);\n      },\n      onResizeStart: e => {\n        this._observeContentResize(false);\n\n        this._actions.onResizeStart(e);\n      },\n      minHeight: 100,\n      minWidth: 100,\n      area: this._positionController.$dragResizeContainer\n    });\n  },\n  _resizeEndHandler: function (e) {\n    var width = this._resizable.option(\"width\");\n\n    var height = this._resizable.option(\"height\");\n\n    width && this._setOptionWithoutOptionChange(\"width\", width);\n    height && this._setOptionWithoutOptionChange(\"height\", height);\n\n    this._cacheDimensions();\n\n    this._positionController.resizeHandled();\n\n    this._positionController.detectVisualPositionChange(e.event);\n\n    this._actions.onResizeEnd(e);\n  },\n  _renderScrollTerminator: function () {\n    var $scrollTerminator = this._$wrapper;\n    var terminatorEventName = addNamespace(dragEventMove, this.NAME);\n    eventsEngine.off($scrollTerminator, terminatorEventName);\n    eventsEngine.on($scrollTerminator, terminatorEventName, {\n      validate: function () {\n        return true;\n      },\n      getDirection: function () {\n        return \"both\";\n      },\n      _toggleGestureCover: function (toggle) {\n        if (!toggle) {\n          this._toggleGestureCoverImpl(toggle);\n        }\n      },\n      _clearSelection: noop,\n      isNative: true\n    }, e => {\n      var originalEvent = e.originalEvent.originalEvent;\n      var {\n        type: type\n      } = originalEvent || {};\n      var isWheel = \"wheel\" === type;\n      var isMouseMove = \"mousemove\" === type;\n      var isScrollByWheel = isWheel && !isCommandKeyPressed(e);\n      e._cancelPreventDefault = true;\n\n      if (originalEvent && false !== e.cancelable && (!isMouseMove && !isWheel || isScrollByWheel)) {\n        e.preventDefault();\n      }\n    });\n  },\n  _getDragTarget: function () {\n    return this.$content();\n  },\n  _moveFromContainer: function () {\n    this._$content.appendTo(this.$element());\n\n    this._detachWrapperToContainer();\n  },\n  _detachWrapperToContainer: function () {\n    this._$wrapper.detach();\n  },\n  _moveToContainer: function () {\n    this._attachWrapperToContainer();\n\n    this._$content.appendTo(this._$wrapper);\n  },\n  _attachWrapperToContainer: function () {\n    var $element = this.$element();\n    var containerDefined = void 0 !== this.option(\"container\");\n    var renderContainer = containerDefined ? this._positionController.$container : swatch.getSwatchContainer($element);\n\n    if (renderContainer && renderContainer[0] === $element.parent()[0]) {\n      renderContainer = $element;\n    }\n\n    this._$wrapper.appendTo(renderContainer);\n  },\n  _renderGeometry: function (options) {\n    var {\n      visible: visible,\n      useResizeObserver: useResizeObserver\n    } = this.option();\n\n    if (visible && hasWindow()) {\n      var isAnimated = this._showAnimationProcessing;\n      var shouldRepeatAnimation = isAnimated && !(null !== options && void 0 !== options && options.forceStopAnimation) && useResizeObserver;\n      this._isAnimationPaused = shouldRepeatAnimation || void 0;\n\n      this._stopAnimation();\n\n      if (null !== options && void 0 !== options && options.shouldOnlyReposition) {\n        this._renderPosition(false);\n      } else {\n        this._renderGeometryImpl(null === options || void 0 === options ? void 0 : options.isDimensionChange);\n      }\n\n      if (shouldRepeatAnimation) {\n        this._animateShowing();\n\n        this._isAnimationPaused = void 0;\n      }\n    }\n  },\n  _cacheDimensions: function () {\n    if (!this.option(\"useResizeObserver\")) {\n      return;\n    }\n\n    this._renderedDimensions = {\n      width: parseInt(getWidth(this._$content), 10),\n      height: parseInt(getHeight(this._$content), 10)\n    };\n  },\n  _renderGeometryImpl: function () {\n    this._positionController.updatePosition(this._getOptionValue(\"position\"));\n\n    this._renderWrapper();\n\n    this._renderDimensions();\n\n    this._renderPosition();\n\n    this._cacheDimensions();\n  },\n\n  _renderPosition() {\n    this._positionController.positionContent();\n  },\n\n  _isAllWindowCovered: function () {\n    return this._positionController.isAllWindowCoveredByWrapper() && this.option(\"shading\");\n  },\n  _toggleSafariScrolling: function () {\n    var visible = this.option(\"visible\");\n    var $body = $(domAdapter.getBody());\n    var isIosSafari = \"ios\" === devices.real().platform && browser.safari;\n\n    var isAllWindowCovered = this._isAllWindowCovered();\n\n    var isScrollingPrevented = $body.hasClass(PREVENT_SAFARI_SCROLLING_CLASS);\n    var shouldPreventScrolling = !isScrollingPrevented && visible && isAllWindowCovered;\n    var shouldEnableScrolling = isScrollingPrevented && (!visible || !isAllWindowCovered || this._disposed);\n\n    if (isIosSafari) {\n      if (shouldEnableScrolling) {\n        $body.removeClass(PREVENT_SAFARI_SCROLLING_CLASS);\n        window.scrollTo(0, this._cachedBodyScrollTop);\n        this._cachedBodyScrollTop = void 0;\n      } else if (shouldPreventScrolling) {\n        this._cachedBodyScrollTop = window.pageYOffset;\n        $body.addClass(PREVENT_SAFARI_SCROLLING_CLASS);\n      }\n    }\n  },\n  _renderWrapper: function () {\n    this._positionController.styleWrapperPosition();\n\n    this._renderWrapperDimensions();\n\n    this._positionController.positionWrapper();\n  },\n  _renderWrapperDimensions: function () {\n    var wrapperWidth;\n    var wrapperHeight;\n    var $container = this._positionController._$wrapperCoveredElement;\n\n    if (!$container) {\n      return;\n    }\n\n    var isWindow = this._positionController.isAllWindowCoveredByWrapper();\n\n    var documentElement = domAdapter.getDocumentElement();\n    wrapperWidth = isWindow ? documentElement.clientWidth : getOuterWidth($container), wrapperHeight = isWindow ? window.innerHeight : getOuterHeight($container);\n\n    this._$wrapper.css({\n      width: wrapperWidth,\n      height: wrapperHeight\n    });\n  },\n  _renderDimensions: function () {\n    var content = this._$content.get(0);\n\n    this._$content.css({\n      minWidth: this._getOptionValue(\"minWidth\", content),\n      maxWidth: this._getOptionValue(\"maxWidth\", content),\n      minHeight: this._getOptionValue(\"minHeight\", content),\n      maxHeight: this._getOptionValue(\"maxHeight\", content),\n      width: this._getOptionValue(\"width\", content),\n      height: this._getOptionValue(\"height\", content)\n    });\n  },\n  _focusTarget: function () {\n    return this._$content;\n  },\n  _attachKeyboardEvents: function () {\n    this._keyboardListenerId = keyboard.on(this._$content, null, opts => this._keyboardHandler(opts));\n  },\n  _keyboardHandler: function (options) {\n    var e = options.originalEvent;\n    var $target = $(e.target);\n\n    if ($target.is(this._$content) || !this.option(\"ignoreChildEvents\")) {\n      this.callBase(...arguments);\n    }\n  },\n  _isVisible: function () {\n    return this.option(\"visible\");\n  },\n  _visibilityChanged: function (visible) {\n    if (visible) {\n      if (this.option(\"visible\")) {\n        this._renderVisibilityAnimate(visible);\n      }\n    } else {\n      this._renderVisibilityAnimate(visible);\n    }\n  },\n  _dimensionChanged: function () {\n    this._renderGeometry({\n      isDimensionChange: true\n    });\n  },\n  _clean: function () {\n    if (!this._contentAlreadyRendered) {\n      this.$content().empty();\n    }\n\n    this._renderVisibility(false);\n\n    this._stopShowTimer();\n\n    this._observeContentResize(false);\n\n    this._cleanFocusState();\n  },\n\n  _stopShowTimer() {\n    if (this._asyncShowTimeout) {\n      clearTimeout(this._asyncShowTimeout);\n    }\n\n    this._asyncShowTimeout = null;\n  },\n\n  _dispose: function () {\n    fx.stop(this._$content, false);\n    clearTimeout(this._deferShowTimer);\n\n    this._toggleViewPortSubscription(false);\n\n    this._toggleSubscriptions(false);\n\n    this._updateZIndexStackPosition(false);\n\n    this._toggleTabTerminator(false);\n\n    this._actions = null;\n    this._parentsScrollSubscriptionInfo = null;\n    this.callBase();\n\n    this._toggleSafariScrolling();\n\n    this.option(\"visible\") && zIndexPool.remove(this._zIndex);\n\n    this._$wrapper.remove();\n\n    this._$content.remove();\n  },\n  _toggleRTLDirection: function (rtl) {\n    this._$content.toggleClass(RTL_DIRECTION_CLASS, rtl);\n  },\n  _optionChanged: function (args) {\n    var _this$_resizable;\n\n    var value = args.value;\n\n    if (inArray(args.name, ACTIONS) > -1) {\n      this._initActions();\n\n      return;\n    }\n\n    switch (args.name) {\n      case \"dragEnabled\":\n        this._renderDrag();\n\n        this._renderGeometry();\n\n        break;\n\n      case \"resizeEnabled\":\n        this._renderResize();\n\n        this._renderGeometry();\n\n        break;\n\n      case \"shading\":\n        this._toggleShading(this.option(\"visible\"));\n\n        this._toggleSafariScrolling();\n\n        break;\n\n      case \"shadingColor\":\n        this._toggleShading(this.option(\"visible\"));\n\n        break;\n\n      case \"width\":\n      case \"height\":\n        this._renderGeometry();\n\n        null === (_this$_resizable = this._resizable) || void 0 === _this$_resizable ? void 0 : _this$_resizable.option(args.name, args.value);\n        break;\n\n      case \"minWidth\":\n      case \"maxWidth\":\n      case \"minHeight\":\n      case \"maxHeight\":\n        this._renderGeometry();\n\n        break;\n\n      case \"position\":\n        this._positionController.updatePosition(this.option(\"position\"));\n\n        this._positionController.restorePositionOnNextRender(true);\n\n        this._renderGeometry();\n\n        this._toggleSafariScrolling();\n\n        break;\n\n      case \"visible\":\n        this._renderVisibilityAnimate(value).done(() => {\n          if (!this._animateDeferred) {\n            return;\n          }\n\n          this._animateDeferred.resolveWith(this);\n        });\n\n        break;\n\n      case \"target\":\n        this._positionController.updateTarget(value);\n\n        this._setAnimationTarget(value);\n\n        this._invalidate();\n\n        break;\n\n      case \"container\":\n        this._positionController.updateContainer(value);\n\n        this._invalidate();\n\n        this._toggleSafariScrolling();\n\n        if (this.option(\"resizeEnabled\")) {\n          var _this$_resizable2;\n\n          null === (_this$_resizable2 = this._resizable) || void 0 === _this$_resizable2 ? void 0 : _this$_resizable2.option(\"area\", this._positionController.$dragResizeContainer);\n        }\n\n        break;\n\n      case \"innerOverlay\":\n        this._initInnerOverlayClass();\n\n        break;\n\n      case \"deferRendering\":\n      case \"contentTemplate\":\n        this._contentAlreadyRendered = false;\n\n        this._clean();\n\n        this._invalidate();\n\n        break;\n\n      case \"hideTopOverlayHandler\":\n        this._toggleHideTopOverlayCallback(false);\n\n        this._initHideTopOverlayHandler(args.value);\n\n        this._toggleHideTopOverlayCallback(this.option(\"visible\"));\n\n        break;\n\n      case \"hideOnParentScroll\":\n        this._toggleHideOnParentsScrollSubscription(this.option(\"visible\"));\n\n        break;\n\n      case \"closeOnOutsideClick\":\n      case \"propagateOutsideClick\":\n        break;\n\n      case \"animation\":\n        this._updateResizeCallbackSkipCondition();\n\n        break;\n\n      case \"rtlEnabled\":\n        this._contentAlreadyRendered = false;\n        this.callBase(args);\n        break;\n\n      case \"_fixWrapperPosition\":\n        this._positionController.fixWrapperPosition = value;\n        break;\n\n      case \"wrapperAttr\":\n        this._renderWrapperAttributes();\n\n        break;\n\n      case \"dragAndResizeArea\":\n        this._positionController.dragAndResizeArea = value;\n\n        if (this.option(\"resizeEnabled\")) {\n          this._resizable.option(\"area\", this._positionController.$dragResizeContainer);\n        }\n\n        this._positionController.positionContent();\n\n        break;\n\n      case \"dragOutsideBoundary\":\n        this._positionController.dragOutsideBoundary = value;\n\n        if (this.option(\"resizeEnabled\")) {\n          this._resizable.option(\"area\", this._positionController.$dragResizeContainer);\n        }\n\n        break;\n\n      case \"outsideDragFactor\":\n        this._positionController.outsideDragFactor = value;\n        break;\n\n      case \"restorePosition\":\n        this._positionController.restorePosition = args.value;\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  toggle: function (showing) {\n    showing = void 0 === showing ? !this.option(\"visible\") : showing;\n    var result = new Deferred();\n\n    if (showing === this.option(\"visible\")) {\n      return result.resolveWith(this, [showing]).promise();\n    }\n\n    var animateDeferred = new Deferred();\n    this._animateDeferred = animateDeferred;\n    this.option(\"visible\", showing);\n    animateDeferred.promise().done(() => {\n      delete this._animateDeferred;\n      result.resolveWith(this, [this.option(\"visible\")]);\n    });\n    return result.promise();\n  },\n  $content: function () {\n    return this._$content;\n  },\n  show: function () {\n    return this.toggle(true);\n  },\n  hide: function () {\n    return this.toggle(false);\n  },\n  content: function () {\n    return getPublicElement(this._$content);\n  },\n  repaint: function () {\n    if (this._contentAlreadyRendered) {\n      this._positionController.restorePositionOnNextRender(true);\n\n      this._renderGeometry({\n        forceStopAnimation: true\n      });\n\n      triggerResizeEvent(this._$content);\n    } else {\n      this.callBase();\n    }\n  }\n});\n\nOverlay.baseZIndex = zIndex => zIndexPool.base(zIndex);\n\nregisterComponent(\"dxOverlay\", Overlay);\nexport default Overlay;","map":{"version":3,"sources":["C:/Users/dzubu/source/repos/bloomteq gui/bloomteqGui/node_modules/devextreme/esm/ui/overlay/ui.overlay.js"],"names":["getOuterWidth","getOuterHeight","getWidth","getHeight","fx","registerComponent","devices","domAdapter","getPublicElement","$","EmptyTemplate","inArray","noop","Deferred","contains","resetActiveElement","extend","each","readyCallbacks","isDefined","isFunction","isPlainObject","isObject","changeCallback","getWindow","hasWindow","errors","eventsEngine","move","dragEventMove","pointerEvents","keyboard","addNamespace","isCommandKeyPressed","normalizeKeyName","triggerHidingEvent","triggerResizeEvent","triggerShownEvent","hideCallback","hideTopOverlayCallback","Resizable","OverlayDrag","tabbable","swatch","Widget","browser","zIndexPool","resizeObserverSingleton","OverlayPositionController","OVERLAY_POSITION_ALIASES","ready","add","window","viewPortChanged","OVERLAY_CLASS","OVERLAY_WRAPPER_CLASS","OVERLAY_CONTENT_CLASS","OVERLAY_SHADER_CLASS","OVERLAY_MODAL_CLASS","INNER_OVERLAY_CLASS","INVISIBLE_STATE_CLASS","ANONYMOUS_TEMPLATE_NAME","RTL_DIRECTION_CLASS","ACTIONS","OVERLAY_STACK","PREVENT_SAFARI_SCROLLING_CLASS","TAB_KEY","subscribeGlobal","getDocument","down","e","i","length","_proxiedDocumentDownHandler","Overlay","inherit","_supportedKeys","callBase","escape","hide","upArrow","_this$_drag","_drag","moveUp","downArrow","_this$_drag2","moveDown","leftArrow","_this$_drag3","moveLeft","rightArrow","_this$_drag4","moveRight","_getDefaultOptions","activeStateEnabled","visible","deferRendering","shading","shadingColor","wrapperAttr","position","center","width","minWidth","maxWidth","height","minHeight","maxHeight","animation","show","type","duration","from","scale","opacity","to","dragOutsideBoundary","closeOnOutsideClick","copyRootClassesToWrapper","_ignoreCopyRootClassesToWrapperDeprecation","_ignoreElementAttrDeprecation","onShowing","onShown","onHiding","onHidden","contentTemplate","dragEnabled","dragAndResizeArea","outsideDragFactor","resizeEnabled","onResizeStart","onResize","onResizeEnd","innerOverlay","restorePosition","target","container","hideTopOverlayHandler","hideOnParentScroll","onPositioned","propagateOutsideClick","ignoreChildEvents","_checkParentVisibility","_fixWrapperPosition","_defaultOptionsRules","concat","device","options","_setOptionsByReference","_optionsByReference","$wrapper","_$wrapper","_eventBindingTarget","_$content","ctor","element","_logDeprecatedOptionWarning","since","message","elementAttr","_init","_initActions","_initCloseOnOutsideClickHandler","_initTabTerminatorHandler","_customWrapperClass","addClass","_initInnerOverlayClass","$element","option","attr","_toggleViewPortSubscription","_initHideTopOverlayHandler","_parentsScrollSubscriptionInfo","handler","_hideOnParentsScrollHandler","_updateResizeCallbackSkipCondition","warnPositionAsFunction","log","_initOptions","_setAnimationTarget","toggleClass","forEach","path","pathParts","split","shift","_hideTopOverlayHandler","_actions","_","action","_createActionByOption","excludeValidators","_this","_documentDownHandler","arguments","_areContentDimensionsRendered","entry","_entry$contentBoxSize","_this$_renderedDimens3","_this$_renderedDimens4","contentBox","contentBoxSize","_this$_renderedDimens","_this$_renderedDimens2","parseInt","inlineSize","_renderedDimensions","blockSize","contentRect","_contentResizeHandler","_shouldSkipContentResize","is","_renderGeometry","shouldOnlyReposition","doesShowAnimationChangeDimensions","_doesShowAnimationChangeDimensions","_showAnimationProcessing","some","prop","_animation$show","config","_observeContentResize","shouldObserve","contentElement","get","observe","unobserve","_initMarkup","_renderWrapperAttributes","_initPositionController","_stopAnimation","isAttachedTarget","document","isInnerOverlay","closest","outsideClick","_outsideClickHandler","preventDefault","_getAnonymousTemplateName","_initTemplates","_templateManager","addDefaultTemplates","content","_isTopOverlay","overlayStack","_overlayStack","tabbableElements","_findTabbableBounds","first","last","_zIndexInitValue","baseZIndex","toggle","_this2","remove","_viewPortChangeHandle","_viewPortChangeHandler","_positionController","updateContainer","_refresh","attributes","classNames","class","removeClass","_renderVisibilityAnimate","_show","_hide","_getAnimationConfig","_getOptionValue","_animateShowing","_this$_getAnimationCo","_showAnimation$start","_showAnimation$comple","_this3","showAnimation","_normalizeAnimation","startShowAnimation","start","completeShowAnimation","complete","_animate","_isAnimationPaused","trigger","_focusTarget","_len","args","Array","_key","call","_isHidden","_toggleSafariScrolling","_showingDeferred","resolve","_len2","_key2","_parentHidden","_isParentHidden","done","_currentVisible","promise","_isHidingActionCanceled","_toggleVisibility","css","_updateZIndexStackPosition","openingHandled","_renderContent","showingArgs","cancel","_isShowingActionCanceled","_moveFromContainer","_renderVisibility","_stopShowTimer","_asyncShowTimeout","setTimeout","skipElementInitialStyles","_position","_animateHiding","_this$_getAnimationCo2","_hideAnimation$start","_hideAnimation$comple","_this4","hideAnimation","startHideAnimation","completeHideAnimation","_this4$_actions","_len3","_key3","_hideAnimationProcessing","_hidingDeferred","_len4","_key4","hidingArgs","_forceFocusLost","_toggleShading","_toggleSubscriptions","activeElement","getActiveElement","shouldResetActiveElement","find","completeCallback","startCallback","animate","stop","_moveToContainer","pushToStack","index","_zIndex","create","push","splice","_toggleTabTerminator","_this5","_proxiedTabTerminatorHandler","_tabKeyHandler","enabled","eventName","NAME","on","off","$elements","elementsCount","result","eq","$firstTabbable","$lastTabbable","isTabOnLast","shiftKey","isShiftTabOnFirst","isEmptyTabList","isOutsideTarget","$focusElement","_toggleHideTopOverlayCallback","_toggleHideOnParentsScrollSubscription","subscribe","needSubscribe","_this$_parentsScrollS","scrollEvent","prevTargets","closeOnScroll","$parents","_hideOnParentScrollTarget","parents","real","deviceType","closeHandled","_render","_appendContentToElement","parent","appendTo","shouldDeferRendering","isParentHidden","_contentAlreadyRendered","$parent","isHidden","getBody","_renderContentImpl","whenContentRendered","contentTemplateOption","_getTemplate","transclude","anonymousTemplateName","render","$content","noModel","onRendered","_dimensionChanged","_renderDrag","_renderResize","_renderScrollTerminator","_getPositionControllerConfig","$root","onVisualPositionChanged","$dragTarget","_getDragTarget","handle","draggableElement","positionController","init","_resizable","_createComponent","handles","_resizeEndHandler","area","$dragResizeContainer","_setOptionWithoutOptionChange","_cacheDimensions","resizeHandled","detectVisualPositionChange","event","$scrollTerminator","terminatorEventName","validate","getDirection","_toggleGestureCover","_toggleGestureCoverImpl","_clearSelection","isNative","originalEvent","isWheel","isMouseMove","isScrollByWheel","_cancelPreventDefault","cancelable","_detachWrapperToContainer","detach","_attachWrapperToContainer","containerDefined","renderContainer","$container","getSwatchContainer","useResizeObserver","isAnimated","shouldRepeatAnimation","forceStopAnimation","_renderPosition","_renderGeometryImpl","isDimensionChange","updatePosition","_renderWrapper","_renderDimensions","positionContent","_isAllWindowCovered","isAllWindowCoveredByWrapper","$body","isIosSafari","platform","safari","isAllWindowCovered","isScrollingPrevented","hasClass","shouldPreventScrolling","shouldEnableScrolling","_disposed","scrollTo","_cachedBodyScrollTop","pageYOffset","styleWrapperPosition","_renderWrapperDimensions","positionWrapper","wrapperWidth","wrapperHeight","_$wrapperCoveredElement","isWindow","documentElement","getDocumentElement","clientWidth","innerHeight","_attachKeyboardEvents","_keyboardListenerId","opts","_keyboardHandler","$target","_isVisible","_visibilityChanged","_clean","empty","_cleanFocusState","clearTimeout","_dispose","_deferShowTimer","_toggleRTLDirection","rtl","_optionChanged","_this$_resizable","value","name","restorePositionOnNextRender","_animateDeferred","resolveWith","updateTarget","_invalidate","_this$_resizable2","fixWrapperPosition","showing","animateDeferred","repaint","zIndex","base"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (esm/ui/overlay/ui.overlay.js)\r\n * Version: 21.2.15\r\n * Build date: Fri Dec 08 2023\r\n *\r\n * Copyright (c) 2012 - 2023 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport {\r\n    getOuterWidth,\r\n    getOuterHeight,\r\n    getWidth,\r\n    getHeight\r\n} from \"../../core/utils/size\";\r\nimport fx from \"../../animation/fx\";\r\nimport registerComponent from \"../../core/component_registrator\";\r\nimport devices from \"../../core/devices\";\r\nimport domAdapter from \"../../core/dom_adapter\";\r\nimport {\r\n    getPublicElement\r\n} from \"../../core/element\";\r\nimport $ from \"../../core/renderer\";\r\nimport {\r\n    EmptyTemplate\r\n} from \"../../core/templates/empty_template\";\r\nimport {\r\n    inArray\r\n} from \"../../core/utils/array\";\r\nimport {\r\n    noop\r\n} from \"../../core/utils/common\";\r\nimport {\r\n    Deferred\r\n} from \"../../core/utils/deferred\";\r\nimport {\r\n    contains,\r\n    resetActiveElement\r\n} from \"../../core/utils/dom\";\r\nimport {\r\n    extend\r\n} from \"../../core/utils/extend\";\r\nimport {\r\n    each\r\n} from \"../../core/utils/iterator\";\r\nimport readyCallbacks from \"../../core/utils/ready_callbacks\";\r\nimport {\r\n    isDefined,\r\n    isFunction,\r\n    isPlainObject,\r\n    isObject\r\n} from \"../../core/utils/type\";\r\nimport {\r\n    changeCallback\r\n} from \"../../core/utils/view_port\";\r\nimport {\r\n    getWindow,\r\n    hasWindow\r\n} from \"../../core/utils/window\";\r\nimport errors from \"../../core/errors\";\r\nimport eventsEngine from \"../../events/core/events_engine\";\r\nimport {\r\n    move as dragEventMove\r\n} from \"../../events/drag\";\r\nimport pointerEvents from \"../../events/pointer\";\r\nimport {\r\n    keyboard\r\n} from \"../../events/short\";\r\nimport {\r\n    addNamespace,\r\n    isCommandKeyPressed,\r\n    normalizeKeyName\r\n} from \"../../events/utils/index\";\r\nimport {\r\n    triggerHidingEvent,\r\n    triggerResizeEvent,\r\n    triggerShownEvent\r\n} from \"../../events/visibility_change\";\r\nimport {\r\n    hideCallback as hideTopOverlayCallback\r\n} from \"../../mobile/hide_callback\";\r\nimport Resizable from \"../resizable\";\r\nimport OverlayDrag from \"./overlay_drag\";\r\nimport {\r\n    tabbable\r\n} from \"../widget/selectors\";\r\nimport swatch from \"../widget/swatch_container\";\r\nimport Widget from \"../widget/ui.widget\";\r\nimport browser from \"../../core/utils/browser\";\r\nimport * as zIndexPool from \"./z_index\";\r\nimport resizeObserverSingleton from \"../../core/resize_observer\";\r\nimport {\r\n    OverlayPositionController,\r\n    OVERLAY_POSITION_ALIASES\r\n} from \"./overlay_position_controller\";\r\nvar ready = readyCallbacks.add;\r\nvar window = getWindow();\r\nvar viewPortChanged = changeCallback;\r\nvar OVERLAY_CLASS = \"dx-overlay\";\r\nvar OVERLAY_WRAPPER_CLASS = \"dx-overlay-wrapper\";\r\nvar OVERLAY_CONTENT_CLASS = \"dx-overlay-content\";\r\nvar OVERLAY_SHADER_CLASS = \"dx-overlay-shader\";\r\nvar OVERLAY_MODAL_CLASS = \"dx-overlay-modal\";\r\nvar INNER_OVERLAY_CLASS = \"dx-inner-overlay\";\r\nvar INVISIBLE_STATE_CLASS = \"dx-state-invisible\";\r\nvar ANONYMOUS_TEMPLATE_NAME = \"content\";\r\nvar RTL_DIRECTION_CLASS = \"dx-rtl\";\r\nvar ACTIONS = [\"onShowing\", \"onShown\", \"onHiding\", \"onHidden\", \"onPositioned\", \"onResizeStart\", \"onResize\", \"onResizeEnd\", \"onVisualPositionChanged\"];\r\nvar OVERLAY_STACK = [];\r\nvar PREVENT_SAFARI_SCROLLING_CLASS = \"dx-prevent-safari-scrolling\";\r\nvar TAB_KEY = \"tab\";\r\nready(() => {\r\n    eventsEngine.subscribeGlobal(domAdapter.getDocument(), pointerEvents.down, e => {\r\n        for (var i = OVERLAY_STACK.length - 1; i >= 0; i--) {\r\n            if (!OVERLAY_STACK[i]._proxiedDocumentDownHandler(e)) {\r\n                return\r\n            }\r\n        }\r\n    })\r\n});\r\nvar Overlay = Widget.inherit({\r\n    _supportedKeys: function() {\r\n        return extend(this.callBase(), {\r\n            escape: function() {\r\n                this.hide()\r\n            },\r\n            upArrow: e => {\r\n                var _this$_drag;\r\n                null === (_this$_drag = this._drag) || void 0 === _this$_drag ? void 0 : _this$_drag.moveUp(e)\r\n            },\r\n            downArrow: e => {\r\n                var _this$_drag2;\r\n                null === (_this$_drag2 = this._drag) || void 0 === _this$_drag2 ? void 0 : _this$_drag2.moveDown(e)\r\n            },\r\n            leftArrow: e => {\r\n                var _this$_drag3;\r\n                null === (_this$_drag3 = this._drag) || void 0 === _this$_drag3 ? void 0 : _this$_drag3.moveLeft(e)\r\n            },\r\n            rightArrow: e => {\r\n                var _this$_drag4;\r\n                null === (_this$_drag4 = this._drag) || void 0 === _this$_drag4 ? void 0 : _this$_drag4.moveRight(e)\r\n            }\r\n        })\r\n    },\r\n    _getDefaultOptions: function() {\r\n        return extend(this.callBase(), {\r\n            activeStateEnabled: false,\r\n            visible: false,\r\n            deferRendering: true,\r\n            shading: true,\r\n            shadingColor: \"\",\r\n            wrapperAttr: {},\r\n            position: extend({}, OVERLAY_POSITION_ALIASES.center),\r\n            width: \"80vw\",\r\n            minWidth: null,\r\n            maxWidth: null,\r\n            height: \"80vh\",\r\n            minHeight: null,\r\n            maxHeight: null,\r\n            animation: {\r\n                show: {\r\n                    type: \"pop\",\r\n                    duration: 300,\r\n                    from: {\r\n                        scale: .55\r\n                    }\r\n                },\r\n                hide: {\r\n                    type: \"pop\",\r\n                    duration: 300,\r\n                    from: {\r\n                        opacity: 1,\r\n                        scale: 1\r\n                    },\r\n                    to: {\r\n                        opacity: 0,\r\n                        scale: .55\r\n                    }\r\n                }\r\n            },\r\n            dragOutsideBoundary: false,\r\n            closeOnOutsideClick: false,\r\n            copyRootClassesToWrapper: false,\r\n            _ignoreCopyRootClassesToWrapperDeprecation: false,\r\n            _ignoreElementAttrDeprecation: false,\r\n            onShowing: null,\r\n            onShown: null,\r\n            onHiding: null,\r\n            onHidden: null,\r\n            contentTemplate: \"content\",\r\n            dragEnabled: false,\r\n            dragAndResizeArea: void 0,\r\n            outsideDragFactor: 0,\r\n            resizeEnabled: false,\r\n            onResizeStart: null,\r\n            onResize: null,\r\n            onResizeEnd: null,\r\n            innerOverlay: false,\r\n            restorePosition: true,\r\n            target: void 0,\r\n            container: void 0,\r\n            hideTopOverlayHandler: () => {\r\n                this.hide()\r\n            },\r\n            hideOnParentScroll: false,\r\n            onPositioned: null,\r\n            propagateOutsideClick: false,\r\n            ignoreChildEvents: true,\r\n            _checkParentVisibility: true,\r\n            _fixWrapperPosition: false\r\n        })\r\n    },\r\n    _defaultOptionsRules: function() {\r\n        return this.callBase().concat([{\r\n            device: function() {\r\n                return !hasWindow()\r\n            },\r\n            options: {\r\n                width: null,\r\n                height: null,\r\n                animation: null,\r\n                _checkParentVisibility: false\r\n            }\r\n        }])\r\n    },\r\n    _setOptionsByReference: function() {\r\n        this.callBase();\r\n        extend(this._optionsByReference, {\r\n            animation: true\r\n        })\r\n    },\r\n    $wrapper: function() {\r\n        return this._$wrapper\r\n    },\r\n    _eventBindingTarget: function() {\r\n        return this._$content\r\n    },\r\n    ctor: function(element, options) {\r\n        this.callBase(element, options);\r\n        if (options) {\r\n            if (options.copyRootClassesToWrapper && !options._ignoreCopyRootClassesToWrapperDeprecation) {\r\n                this._logDeprecatedOptionWarning(\"copyRootClassesToWrapper\", {\r\n                    since: \"21.2\",\r\n                    message: 'Use the \"wrapperAttr\" option instead'\r\n                })\r\n            }\r\n            if (options.elementAttr && !options._ignoreElementAttrDeprecation) {\r\n                this._logDeprecatedOptionWarning(\"elementAttr\", {\r\n                    since: \"21.2\",\r\n                    message: 'Use the \"wrapperAttr\" option instead'\r\n                })\r\n            }\r\n        }\r\n    },\r\n    _init: function() {\r\n        this.callBase();\r\n        this._initActions();\r\n        this._initCloseOnOutsideClickHandler();\r\n        this._initTabTerminatorHandler();\r\n        this._customWrapperClass = null;\r\n        this._$wrapper = $(\"<div>\").addClass(OVERLAY_WRAPPER_CLASS);\r\n        this._$content = $(\"<div>\").addClass(OVERLAY_CONTENT_CLASS);\r\n        this._initInnerOverlayClass();\r\n        var $element = this.$element();\r\n        if (this.option(\"copyRootClassesToWrapper\")) {\r\n            this._$wrapper.addClass($element.attr(\"class\"))\r\n        }\r\n        $element.addClass(OVERLAY_CLASS);\r\n        this._$wrapper.attr(\"data-bind\", \"dxControlsDescendantBindings: true\");\r\n        this._toggleViewPortSubscription(true);\r\n        this._initHideTopOverlayHandler(this.option(\"hideTopOverlayHandler\"));\r\n        this._parentsScrollSubscriptionInfo = {\r\n            handler: e => {\r\n                this._hideOnParentsScrollHandler(e)\r\n            }\r\n        };\r\n        this._updateResizeCallbackSkipCondition();\r\n        this.warnPositionAsFunction()\r\n    },\r\n    warnPositionAsFunction() {\r\n        if (isFunction(this.option(\"position\"))) {\r\n            errors.log(\"W0018\")\r\n        }\r\n    },\r\n    _initOptions: function(options) {\r\n        this._setAnimationTarget(options.target);\r\n        this.callBase(options)\r\n    },\r\n    _initInnerOverlayClass: function() {\r\n        this._$content.toggleClass(INNER_OVERLAY_CLASS, this.option(\"innerOverlay\"))\r\n    },\r\n    _setAnimationTarget: function(target) {\r\n        if (!isDefined(target)) {\r\n            return\r\n        }\r\n        var options = this.option();\r\n        [\"animation.show.from.position.of\", \"animation.show.to.position.of\", \"animation.hide.from.position.of\", \"animation.hide.to.position.of\"].forEach(path => {\r\n            var pathParts = path.split(\".\");\r\n            var option = options;\r\n            while (option) {\r\n                if (1 === pathParts.length) {\r\n                    if (isPlainObject(option)) {\r\n                        option[pathParts.shift()] = target\r\n                    }\r\n                    break\r\n                } else {\r\n                    option = option[pathParts.shift()]\r\n                }\r\n            }\r\n        })\r\n    },\r\n    _initHideTopOverlayHandler: function(handler) {\r\n        this._hideTopOverlayHandler = handler\r\n    },\r\n    _initActions: function() {\r\n        this._actions = {};\r\n        each(ACTIONS, (_, action) => {\r\n            this._actions[action] = this._createActionByOption(action, {\r\n                excludeValidators: [\"disabled\", \"readOnly\"]\r\n            }) || noop\r\n        })\r\n    },\r\n    _initCloseOnOutsideClickHandler: function() {\r\n        var _this = this;\r\n        this._proxiedDocumentDownHandler = function() {\r\n            return _this._documentDownHandler(...arguments)\r\n        }\r\n    },\r\n    _areContentDimensionsRendered: function(entry) {\r\n        var _entry$contentBoxSize, _this$_renderedDimens3, _this$_renderedDimens4;\r\n        var contentBox = null === (_entry$contentBoxSize = entry.contentBoxSize) || void 0 === _entry$contentBoxSize ? void 0 : _entry$contentBoxSize[0];\r\n        if (contentBox) {\r\n            var _this$_renderedDimens, _this$_renderedDimens2;\r\n            return parseInt(contentBox.inlineSize, 10) === (null === (_this$_renderedDimens = this._renderedDimensions) || void 0 === _this$_renderedDimens ? void 0 : _this$_renderedDimens.width) && parseInt(contentBox.blockSize, 10) === (null === (_this$_renderedDimens2 = this._renderedDimensions) || void 0 === _this$_renderedDimens2 ? void 0 : _this$_renderedDimens2.height)\r\n        }\r\n        var contentRect = entry.contentRect;\r\n        return parseInt(contentRect.width, 10) === (null === (_this$_renderedDimens3 = this._renderedDimensions) || void 0 === _this$_renderedDimens3 ? void 0 : _this$_renderedDimens3.width) && parseInt(contentRect.height, 10) === (null === (_this$_renderedDimens4 = this._renderedDimensions) || void 0 === _this$_renderedDimens4 ? void 0 : _this$_renderedDimens4.height)\r\n    },\r\n    _contentResizeHandler: function(entry) {\r\n        if (!this._shouldSkipContentResize(entry) && this._$content.is(\":visible\")) {\r\n            this._renderGeometry({\r\n                shouldOnlyReposition: true\r\n            })\r\n        }\r\n    },\r\n    _updateResizeCallbackSkipCondition() {\r\n        var doesShowAnimationChangeDimensions = this._doesShowAnimationChangeDimensions();\r\n        this._shouldSkipContentResize = entry => doesShowAnimationChangeDimensions && this._showAnimationProcessing || this._areContentDimensionsRendered(entry)\r\n    },\r\n    _doesShowAnimationChangeDimensions: function() {\r\n        var animation = this.option(\"animation\");\r\n        return [\"to\", \"from\"].some(prop => {\r\n            var _animation$show;\r\n            var config = null === animation || void 0 === animation ? void 0 : null === (_animation$show = animation.show) || void 0 === _animation$show ? void 0 : _animation$show[prop];\r\n            return isObject(config) && (\"width\" in config || \"height\" in config)\r\n        })\r\n    },\r\n    _observeContentResize: function(shouldObserve) {\r\n        if (!this.option(\"useResizeObserver\")) {\r\n            return\r\n        }\r\n        var contentElement = this._$content.get(0);\r\n        if (shouldObserve) {\r\n            resizeObserverSingleton.observe(contentElement, entry => {\r\n                this._contentResizeHandler(entry)\r\n            })\r\n        } else {\r\n            resizeObserverSingleton.unobserve(contentElement)\r\n        }\r\n    },\r\n    _initMarkup() {\r\n        this.callBase();\r\n        this._renderWrapperAttributes();\r\n        this._initPositionController()\r\n    },\r\n    _documentDownHandler: function(e) {\r\n        if (this._showAnimationProcessing) {\r\n            this._stopAnimation()\r\n        }\r\n        var closeOnOutsideClick = this.option(\"closeOnOutsideClick\");\r\n        if (isFunction(closeOnOutsideClick)) {\r\n            closeOnOutsideClick = closeOnOutsideClick(e)\r\n        }\r\n        var isAttachedTarget = $(window.document).is(e.target) || contains(window.document, e.target);\r\n        var isInnerOverlay = $(e.target).closest(\".\".concat(INNER_OVERLAY_CLASS)).length;\r\n        var outsideClick = isAttachedTarget && !isInnerOverlay && !(this._$content.is(e.target) || contains(this._$content.get(0), e.target));\r\n        if (outsideClick && closeOnOutsideClick) {\r\n            this._outsideClickHandler(e)\r\n        }\r\n        return this.option(\"propagateOutsideClick\")\r\n    },\r\n    _outsideClickHandler(e) {\r\n        if (this.option(\"shading\")) {\r\n            e.preventDefault()\r\n        }\r\n        this.hide()\r\n    },\r\n    _getAnonymousTemplateName: function() {\r\n        return ANONYMOUS_TEMPLATE_NAME\r\n    },\r\n    _initTemplates: function() {\r\n        this._templateManager.addDefaultTemplates({\r\n            content: new EmptyTemplate\r\n        });\r\n        this.callBase()\r\n    },\r\n    _isTopOverlay: function() {\r\n        var overlayStack = this._overlayStack();\r\n        for (var i = overlayStack.length - 1; i >= 0; i--) {\r\n            var tabbableElements = overlayStack[i]._findTabbableBounds();\r\n            if (tabbableElements.first || tabbableElements.last) {\r\n                return overlayStack[i] === this\r\n            }\r\n        }\r\n        return false\r\n    },\r\n    _overlayStack: function() {\r\n        return OVERLAY_STACK\r\n    },\r\n    _zIndexInitValue: function() {\r\n        return Overlay.baseZIndex()\r\n    },\r\n    _toggleViewPortSubscription: function(toggle) {\r\n        var _this2 = this;\r\n        viewPortChanged.remove(this._viewPortChangeHandle);\r\n        if (toggle) {\r\n            this._viewPortChangeHandle = function() {\r\n                _this2._viewPortChangeHandler(...arguments)\r\n            };\r\n            viewPortChanged.add(this._viewPortChangeHandle)\r\n        }\r\n    },\r\n    _viewPortChangeHandler: function() {\r\n        this._positionController.updateContainer(this.option(\"container\"));\r\n        this._refresh()\r\n    },\r\n    _renderWrapperAttributes() {\r\n        var {\r\n            wrapperAttr: wrapperAttr\r\n        } = this.option();\r\n        var attributes = extend({}, wrapperAttr);\r\n        var classNames = attributes.class;\r\n        delete attributes.class;\r\n        this.$wrapper().attr(attributes).removeClass(this._customWrapperClass).addClass(classNames);\r\n        this._customWrapperClass = classNames\r\n    },\r\n    _renderVisibilityAnimate: function(visible) {\r\n        this._observeContentResize(visible);\r\n        this._stopAnimation();\r\n        return visible ? this._show() : this._hide()\r\n    },\r\n    _getAnimationConfig: function() {\r\n        return this._getOptionValue(\"animation\", this)\r\n    },\r\n    _animateShowing: function() {\r\n        var _this$_getAnimationCo, _showAnimation$start, _showAnimation$comple, _this3 = this;\r\n        var animation = null !== (_this$_getAnimationCo = this._getAnimationConfig()) && void 0 !== _this$_getAnimationCo ? _this$_getAnimationCo : {};\r\n        var showAnimation = this._normalizeAnimation(animation.show, \"to\");\r\n        var startShowAnimation = null !== (_showAnimation$start = null === showAnimation || void 0 === showAnimation ? void 0 : showAnimation.start) && void 0 !== _showAnimation$start ? _showAnimation$start : noop;\r\n        var completeShowAnimation = null !== (_showAnimation$comple = null === showAnimation || void 0 === showAnimation ? void 0 : showAnimation.complete) && void 0 !== _showAnimation$comple ? _showAnimation$comple : noop;\r\n        this._animate(showAnimation, (function() {\r\n            if (_this3._isAnimationPaused) {\r\n                return\r\n            }\r\n            if (_this3.option(\"focusStateEnabled\")) {\r\n                eventsEngine.trigger(_this3._focusTarget(), \"focus\")\r\n            }\r\n            for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\r\n                args[_key] = arguments[_key]\r\n            }\r\n            completeShowAnimation.call(_this3, ...args);\r\n            _this3._showAnimationProcessing = false;\r\n            _this3._isHidden = false;\r\n            _this3._actions.onShown();\r\n            _this3._toggleSafariScrolling();\r\n            _this3._showingDeferred.resolve()\r\n        }), (function() {\r\n            if (_this3._isAnimationPaused) {\r\n                return\r\n            }\r\n            for (var _len2 = arguments.length, args = new Array(_len2), _key2 = 0; _key2 < _len2; _key2++) {\r\n                args[_key2] = arguments[_key2]\r\n            }\r\n            startShowAnimation.call(_this3, ...args);\r\n            _this3._showAnimationProcessing = true\r\n        }))\r\n    },\r\n    _show: function() {\r\n        this._showingDeferred = new Deferred;\r\n        this._parentHidden = this._isParentHidden();\r\n        this._showingDeferred.done(() => {\r\n            delete this._parentHidden\r\n        });\r\n        if (this._parentHidden) {\r\n            this._isHidden = true;\r\n            return this._showingDeferred.resolve()\r\n        }\r\n        if (this._currentVisible) {\r\n            return (new Deferred).resolve().promise()\r\n        }\r\n        this._currentVisible = true;\r\n        if (this._isHidingActionCanceled) {\r\n            delete this._isHidingActionCanceled;\r\n            this._showingDeferred.resolve()\r\n        } else {\r\n            var show = () => {\r\n                this._stopAnimation();\r\n                this._toggleVisibility(true);\r\n                this._$content.css(\"visibility\", \"hidden\");\r\n                this._$content.toggleClass(INVISIBLE_STATE_CLASS, false);\r\n                this._updateZIndexStackPosition(true);\r\n                this._positionController.openingHandled();\r\n                this._renderContent();\r\n                var showingArgs = {\r\n                    cancel: false\r\n                };\r\n                this._actions.onShowing(showingArgs);\r\n                if (showingArgs.cancel) {\r\n                    (() => {\r\n                        this._toggleVisibility(false);\r\n                        this._$content.css(\"visibility\", \"\");\r\n                        this._$content.toggleClass(INVISIBLE_STATE_CLASS, true);\r\n                        this._isShowingActionCanceled = true;\r\n                        this._moveFromContainer();\r\n                        this.option(\"visible\", false);\r\n                        this._showingDeferred.resolve()\r\n                    })()\r\n                } else {\r\n                    (() => {\r\n                        this._$content.css(\"visibility\", \"\");\r\n                        this._renderVisibility(true);\r\n                        this._animateShowing()\r\n                    })()\r\n                }\r\n            };\r\n            if (this.option(\"templatesRenderAsynchronously\")) {\r\n                this._stopShowTimer();\r\n                this._asyncShowTimeout = setTimeout(show)\r\n            } else {\r\n                show()\r\n            }\r\n        }\r\n        return this._showingDeferred.promise()\r\n    },\r\n    _normalizeAnimation: function(animation, prop) {\r\n        if (animation) {\r\n            animation = extend({\r\n                type: \"slide\",\r\n                skipElementInitialStyles: true\r\n            }, animation);\r\n            if (animation[prop] && \"object\" === typeof animation[prop]) {\r\n                extend(animation[prop], {\r\n                    position: this._positionController._position\r\n                })\r\n            }\r\n        }\r\n        return animation\r\n    },\r\n    _animateHiding: function() {\r\n        var _this$_getAnimationCo2, _hideAnimation$start, _hideAnimation$comple, _this4 = this;\r\n        var animation = null !== (_this$_getAnimationCo2 = this._getAnimationConfig()) && void 0 !== _this$_getAnimationCo2 ? _this$_getAnimationCo2 : {};\r\n        var hideAnimation = this._normalizeAnimation(animation.hide, \"from\");\r\n        var startHideAnimation = null !== (_hideAnimation$start = null === hideAnimation || void 0 === hideAnimation ? void 0 : hideAnimation.start) && void 0 !== _hideAnimation$start ? _hideAnimation$start : noop;\r\n        var completeHideAnimation = null !== (_hideAnimation$comple = null === hideAnimation || void 0 === hideAnimation ? void 0 : hideAnimation.complete) && void 0 !== _hideAnimation$comple ? _hideAnimation$comple : noop;\r\n        this._animate(hideAnimation, (function() {\r\n            var _this4$_actions;\r\n            _this4._$content.css(\"pointerEvents\", \"\");\r\n            _this4._renderVisibility(false);\r\n            for (var _len3 = arguments.length, args = new Array(_len3), _key3 = 0; _key3 < _len3; _key3++) {\r\n                args[_key3] = arguments[_key3]\r\n            }\r\n            completeHideAnimation.call(_this4, ...args);\r\n            _this4._hideAnimationProcessing = false;\r\n            null === (_this4$_actions = _this4._actions) || void 0 === _this4$_actions ? void 0 : _this4$_actions.onHidden();\r\n            _this4._hidingDeferred.resolve()\r\n        }), (function() {\r\n            _this4._$content.css(\"pointerEvents\", \"none\");\r\n            for (var _len4 = arguments.length, args = new Array(_len4), _key4 = 0; _key4 < _len4; _key4++) {\r\n                args[_key4] = arguments[_key4]\r\n            }\r\n            startHideAnimation.call(_this4, ...args);\r\n            _this4._hideAnimationProcessing = true\r\n        }))\r\n    },\r\n    _hide: function() {\r\n        if (!this._currentVisible) {\r\n            return (new Deferred).resolve().promise()\r\n        }\r\n        this._currentVisible = false;\r\n        this._hidingDeferred = new Deferred;\r\n        var hidingArgs = {\r\n            cancel: false\r\n        };\r\n        if (this._isShowingActionCanceled) {\r\n            delete this._isShowingActionCanceled;\r\n            this._hidingDeferred.resolve()\r\n        } else {\r\n            this._actions.onHiding(hidingArgs);\r\n            this._toggleSafariScrolling();\r\n            if (hidingArgs.cancel) {\r\n                (() => {\r\n                    this._isHidingActionCanceled = true;\r\n                    this.option(\"visible\", true);\r\n                    this._hidingDeferred.resolve()\r\n                })()\r\n            } else {\r\n                (() => {\r\n                    this._forceFocusLost();\r\n                    this._toggleShading(false);\r\n                    this._toggleSubscriptions(false);\r\n                    this._stopShowTimer();\r\n                    this._animateHiding()\r\n                })()\r\n            }\r\n        }\r\n        return this._hidingDeferred.promise()\r\n    },\r\n    _forceFocusLost: function() {\r\n        var activeElement = domAdapter.getActiveElement();\r\n        var shouldResetActiveElement = !!this._$content.find(activeElement).length;\r\n        if (shouldResetActiveElement) {\r\n            resetActiveElement()\r\n        }\r\n    },\r\n    _animate: function(animation, completeCallback, startCallback) {\r\n        if (animation) {\r\n            startCallback = startCallback || animation.start || noop;\r\n            fx.animate(this._$content, extend({}, animation, {\r\n                start: startCallback,\r\n                complete: completeCallback\r\n            }))\r\n        } else {\r\n            completeCallback()\r\n        }\r\n    },\r\n    _stopAnimation: function() {\r\n        fx.stop(this._$content, true)\r\n    },\r\n    _renderVisibility: function(visible) {\r\n        if (visible && this._isParentHidden()) {\r\n            return\r\n        }\r\n        this._currentVisible = visible;\r\n        this._stopAnimation();\r\n        if (!visible) {\r\n            triggerHidingEvent(this._$content)\r\n        }\r\n        if (visible) {\r\n            this._moveToContainer();\r\n            this._renderGeometry();\r\n            triggerShownEvent(this._$content);\r\n            triggerResizeEvent(this._$content)\r\n        } else {\r\n            this._toggleVisibility(visible);\r\n            this._$content.toggleClass(INVISIBLE_STATE_CLASS, !visible);\r\n            this._updateZIndexStackPosition(visible);\r\n            this._moveFromContainer()\r\n        }\r\n        this._toggleShading(visible);\r\n        this._toggleSubscriptions(visible)\r\n    },\r\n    _updateZIndexStackPosition: function(pushToStack) {\r\n        var overlayStack = this._overlayStack();\r\n        var index = inArray(this, overlayStack);\r\n        if (pushToStack) {\r\n            if (-1 === index) {\r\n                this._zIndex = zIndexPool.create(this._zIndexInitValue());\r\n                overlayStack.push(this)\r\n            }\r\n            this._$wrapper.css(\"zIndex\", this._zIndex);\r\n            this._$content.css(\"zIndex\", this._zIndex)\r\n        } else if (-1 !== index) {\r\n            overlayStack.splice(index, 1);\r\n            zIndexPool.remove(this._zIndex)\r\n        }\r\n    },\r\n    _toggleShading: function(visible) {\r\n        this._$wrapper.toggleClass(OVERLAY_MODAL_CLASS, this.option(\"shading\") && !this.option(\"container\"));\r\n        this._$wrapper.toggleClass(OVERLAY_SHADER_CLASS, visible && this.option(\"shading\"));\r\n        this._$wrapper.css(\"backgroundColor\", this.option(\"shading\") ? this.option(\"shadingColor\") : \"\");\r\n        this._toggleTabTerminator(visible && this.option(\"shading\"))\r\n    },\r\n    _initTabTerminatorHandler: function() {\r\n        var _this5 = this;\r\n        this._proxiedTabTerminatorHandler = function() {\r\n            _this5._tabKeyHandler(...arguments)\r\n        }\r\n    },\r\n    _toggleTabTerminator: function(enabled) {\r\n        var eventName = addNamespace(\"keydown\", this.NAME);\r\n        if (enabled) {\r\n            eventsEngine.on(domAdapter.getDocument(), eventName, this._proxiedTabTerminatorHandler)\r\n        } else {\r\n            eventsEngine.off(domAdapter.getDocument(), eventName, this._proxiedTabTerminatorHandler)\r\n        }\r\n    },\r\n    _findTabbableBounds: function() {\r\n        var $elements = this._$wrapper.find(\"*\");\r\n        var elementsCount = $elements.length - 1;\r\n        var result = {\r\n            first: null,\r\n            last: null\r\n        };\r\n        for (var i = 0; i <= elementsCount; i++) {\r\n            if (!result.first && $elements.eq(i).is(tabbable)) {\r\n                result.first = $elements.eq(i)\r\n            }\r\n            if (!result.last && $elements.eq(elementsCount - i).is(tabbable)) {\r\n                result.last = $elements.eq(elementsCount - i)\r\n            }\r\n            if (result.first && result.last) {\r\n                break\r\n            }\r\n        }\r\n        return result\r\n    },\r\n    _tabKeyHandler: function(e) {\r\n        if (normalizeKeyName(e) !== TAB_KEY || !this._isTopOverlay()) {\r\n            return\r\n        }\r\n        var tabbableElements = this._findTabbableBounds();\r\n        var $firstTabbable = tabbableElements.first;\r\n        var $lastTabbable = tabbableElements.last;\r\n        var isTabOnLast = !e.shiftKey && e.target === $lastTabbable.get(0);\r\n        var isShiftTabOnFirst = e.shiftKey && e.target === $firstTabbable.get(0);\r\n        var isEmptyTabList = 0 === tabbableElements.length;\r\n        var isOutsideTarget = !contains(this._$wrapper.get(0), e.target);\r\n        if (isTabOnLast || isShiftTabOnFirst || isEmptyTabList || isOutsideTarget) {\r\n            e.preventDefault();\r\n            var $focusElement = e.shiftKey ? $lastTabbable : $firstTabbable;\r\n            eventsEngine.trigger($focusElement, \"focusin\");\r\n            eventsEngine.trigger($focusElement, \"focus\")\r\n        }\r\n    },\r\n    _toggleSubscriptions: function(enabled) {\r\n        if (hasWindow()) {\r\n            this._toggleHideTopOverlayCallback(enabled);\r\n            this._toggleHideOnParentsScrollSubscription(enabled)\r\n        }\r\n    },\r\n    _toggleHideTopOverlayCallback: function(subscribe) {\r\n        if (!this._hideTopOverlayHandler) {\r\n            return\r\n        }\r\n        if (subscribe) {\r\n            hideTopOverlayCallback.add(this._hideTopOverlayHandler)\r\n        } else {\r\n            hideTopOverlayCallback.remove(this._hideTopOverlayHandler)\r\n        }\r\n    },\r\n    _toggleHideOnParentsScrollSubscription: function(needSubscribe) {\r\n        var _this$_parentsScrollS;\r\n        var scrollEvent = addNamespace(\"scroll\", this.NAME);\r\n        var {\r\n            prevTargets: prevTargets,\r\n            handler: handler\r\n        } = null !== (_this$_parentsScrollS = this._parentsScrollSubscriptionInfo) && void 0 !== _this$_parentsScrollS ? _this$_parentsScrollS : {};\r\n        eventsEngine.off(prevTargets, scrollEvent, handler);\r\n        var closeOnScroll = this.option(\"hideOnParentScroll\");\r\n        if (needSubscribe && closeOnScroll) {\r\n            var $parents = this._hideOnParentScrollTarget().parents();\r\n            if (\"desktop\" === devices.real().deviceType) {\r\n                $parents = $parents.add(window)\r\n            }\r\n            eventsEngine.on($parents, scrollEvent, handler);\r\n            this._parentsScrollSubscriptionInfo.prevTargets = $parents\r\n        }\r\n    },\r\n    _hideOnParentsScrollHandler: function(e) {\r\n        var closeHandled = false;\r\n        var closeOnScroll = this.option(\"hideOnParentScroll\");\r\n        if (isFunction(closeOnScroll)) {\r\n            closeHandled = closeOnScroll(e)\r\n        }\r\n        if (!closeHandled && !this._showAnimationProcessing) {\r\n            this.hide()\r\n        }\r\n    },\r\n    _hideOnParentScrollTarget: function() {\r\n        return this._$wrapper\r\n    },\r\n    _render: function() {\r\n        this.callBase();\r\n        this._appendContentToElement();\r\n        this._renderVisibilityAnimate(this.option(\"visible\"))\r\n    },\r\n    _appendContentToElement: function() {\r\n        if (!this._$content.parent().is(this.$element())) {\r\n            this._$content.appendTo(this.$element())\r\n        }\r\n    },\r\n    _renderContent: function() {\r\n        var shouldDeferRendering = !this._currentVisible && this.option(\"deferRendering\");\r\n        var isParentHidden = this.option(\"visible\") && this._isParentHidden();\r\n        if (isParentHidden) {\r\n            this._isHidden = true;\r\n            return\r\n        }\r\n        if (this._contentAlreadyRendered || shouldDeferRendering) {\r\n            return\r\n        }\r\n        this._contentAlreadyRendered = true;\r\n        this._appendContentToElement();\r\n        this.callBase()\r\n    },\r\n    _isParentHidden: function() {\r\n        if (!this.option(\"_checkParentVisibility\")) {\r\n            return false\r\n        }\r\n        if (void 0 !== this._parentHidden) {\r\n            return this._parentHidden\r\n        }\r\n        var $parent = this.$element().parent();\r\n        if ($parent.is(\":visible\")) {\r\n            return false\r\n        }\r\n        var isHidden = false;\r\n        $parent.add($parent.parents()).each((function() {\r\n            var $element = $(this);\r\n            if (\"none\" === $element.css(\"display\")) {\r\n                isHidden = true;\r\n                return false\r\n            }\r\n        }));\r\n        return isHidden || !domAdapter.getBody().contains($parent.get(0))\r\n    },\r\n    _renderContentImpl: function() {\r\n        var whenContentRendered = new Deferred;\r\n        var contentTemplateOption = this.option(\"contentTemplate\");\r\n        var contentTemplate = this._getTemplate(contentTemplateOption);\r\n        var transclude = this._templateManager.anonymousTemplateName === contentTemplateOption;\r\n        contentTemplate && contentTemplate.render({\r\n            container: getPublicElement(this.$content()),\r\n            noModel: true,\r\n            transclude: transclude,\r\n            onRendered: () => {\r\n                whenContentRendered.resolve();\r\n                if (this.option(\"templatesRenderAsynchronously\")) {\r\n                    this._dimensionChanged()\r\n                }\r\n            }\r\n        });\r\n        this._renderDrag();\r\n        this._renderResize();\r\n        this._renderScrollTerminator();\r\n        whenContentRendered.done(() => {\r\n            if (this.option(\"visible\")) {\r\n                this._moveToContainer()\r\n            }\r\n        });\r\n        return whenContentRendered.promise()\r\n    },\r\n    _getPositionControllerConfig() {\r\n        var {\r\n            target: target,\r\n            container: container,\r\n            dragAndResizeArea: dragAndResizeArea,\r\n            dragOutsideBoundary: dragOutsideBoundary,\r\n            outsideDragFactor: outsideDragFactor,\r\n            _fixWrapperPosition: _fixWrapperPosition,\r\n            restorePosition: restorePosition\r\n        } = this.option();\r\n        return {\r\n            target: target,\r\n            container: container,\r\n            $root: this.$element(),\r\n            $content: this._$content,\r\n            $wrapper: this._$wrapper,\r\n            onPositioned: this._actions.onPositioned,\r\n            onVisualPositionChanged: this._actions.onVisualPositionChanged,\r\n            restorePosition: restorePosition,\r\n            dragAndResizeArea: dragAndResizeArea,\r\n            dragOutsideBoundary: dragOutsideBoundary,\r\n            outsideDragFactor: outsideDragFactor,\r\n            _fixWrapperPosition: _fixWrapperPosition\r\n        }\r\n    },\r\n    _initPositionController() {\r\n        this._positionController = new OverlayPositionController(this._getPositionControllerConfig())\r\n    },\r\n    _renderDrag: function() {\r\n        var $dragTarget = this._getDragTarget();\r\n        if (!$dragTarget) {\r\n            return\r\n        }\r\n        var config = {\r\n            dragEnabled: this.option(\"dragEnabled\"),\r\n            handle: $dragTarget.get(0),\r\n            draggableElement: this._$content.get(0),\r\n            positionController: this._positionController\r\n        };\r\n        if (this._drag) {\r\n            this._drag.init(config)\r\n        } else {\r\n            this._drag = new OverlayDrag(config)\r\n        }\r\n    },\r\n    _renderResize: function() {\r\n        this._resizable = this._createComponent(this._$content, Resizable, {\r\n            handles: this.option(\"resizeEnabled\") ? \"all\" : \"none\",\r\n            onResizeEnd: e => {\r\n                this._resizeEndHandler(e);\r\n                this._observeContentResize(true)\r\n            },\r\n            onResize: e => {\r\n                this._actions.onResize(e)\r\n            },\r\n            onResizeStart: e => {\r\n                this._observeContentResize(false);\r\n                this._actions.onResizeStart(e)\r\n            },\r\n            minHeight: 100,\r\n            minWidth: 100,\r\n            area: this._positionController.$dragResizeContainer\r\n        })\r\n    },\r\n    _resizeEndHandler: function(e) {\r\n        var width = this._resizable.option(\"width\");\r\n        var height = this._resizable.option(\"height\");\r\n        width && this._setOptionWithoutOptionChange(\"width\", width);\r\n        height && this._setOptionWithoutOptionChange(\"height\", height);\r\n        this._cacheDimensions();\r\n        this._positionController.resizeHandled();\r\n        this._positionController.detectVisualPositionChange(e.event);\r\n        this._actions.onResizeEnd(e)\r\n    },\r\n    _renderScrollTerminator: function() {\r\n        var $scrollTerminator = this._$wrapper;\r\n        var terminatorEventName = addNamespace(dragEventMove, this.NAME);\r\n        eventsEngine.off($scrollTerminator, terminatorEventName);\r\n        eventsEngine.on($scrollTerminator, terminatorEventName, {\r\n            validate: function() {\r\n                return true\r\n            },\r\n            getDirection: function() {\r\n                return \"both\"\r\n            },\r\n            _toggleGestureCover: function(toggle) {\r\n                if (!toggle) {\r\n                    this._toggleGestureCoverImpl(toggle)\r\n                }\r\n            },\r\n            _clearSelection: noop,\r\n            isNative: true\r\n        }, e => {\r\n            var originalEvent = e.originalEvent.originalEvent;\r\n            var {\r\n                type: type\r\n            } = originalEvent || {};\r\n            var isWheel = \"wheel\" === type;\r\n            var isMouseMove = \"mousemove\" === type;\r\n            var isScrollByWheel = isWheel && !isCommandKeyPressed(e);\r\n            e._cancelPreventDefault = true;\r\n            if (originalEvent && false !== e.cancelable && (!isMouseMove && !isWheel || isScrollByWheel)) {\r\n                e.preventDefault()\r\n            }\r\n        })\r\n    },\r\n    _getDragTarget: function() {\r\n        return this.$content()\r\n    },\r\n    _moveFromContainer: function() {\r\n        this._$content.appendTo(this.$element());\r\n        this._detachWrapperToContainer()\r\n    },\r\n    _detachWrapperToContainer: function() {\r\n        this._$wrapper.detach()\r\n    },\r\n    _moveToContainer: function() {\r\n        this._attachWrapperToContainer();\r\n        this._$content.appendTo(this._$wrapper)\r\n    },\r\n    _attachWrapperToContainer: function() {\r\n        var $element = this.$element();\r\n        var containerDefined = void 0 !== this.option(\"container\");\r\n        var renderContainer = containerDefined ? this._positionController.$container : swatch.getSwatchContainer($element);\r\n        if (renderContainer && renderContainer[0] === $element.parent()[0]) {\r\n            renderContainer = $element\r\n        }\r\n        this._$wrapper.appendTo(renderContainer)\r\n    },\r\n    _renderGeometry: function(options) {\r\n        var {\r\n            visible: visible,\r\n            useResizeObserver: useResizeObserver\r\n        } = this.option();\r\n        if (visible && hasWindow()) {\r\n            var isAnimated = this._showAnimationProcessing;\r\n            var shouldRepeatAnimation = isAnimated && !(null !== options && void 0 !== options && options.forceStopAnimation) && useResizeObserver;\r\n            this._isAnimationPaused = shouldRepeatAnimation || void 0;\r\n            this._stopAnimation();\r\n            if (null !== options && void 0 !== options && options.shouldOnlyReposition) {\r\n                this._renderPosition(false)\r\n            } else {\r\n                this._renderGeometryImpl(null === options || void 0 === options ? void 0 : options.isDimensionChange)\r\n            }\r\n            if (shouldRepeatAnimation) {\r\n                this._animateShowing();\r\n                this._isAnimationPaused = void 0\r\n            }\r\n        }\r\n    },\r\n    _cacheDimensions: function() {\r\n        if (!this.option(\"useResizeObserver\")) {\r\n            return\r\n        }\r\n        this._renderedDimensions = {\r\n            width: parseInt(getWidth(this._$content), 10),\r\n            height: parseInt(getHeight(this._$content), 10)\r\n        }\r\n    },\r\n    _renderGeometryImpl: function() {\r\n        this._positionController.updatePosition(this._getOptionValue(\"position\"));\r\n        this._renderWrapper();\r\n        this._renderDimensions();\r\n        this._renderPosition();\r\n        this._cacheDimensions()\r\n    },\r\n    _renderPosition() {\r\n        this._positionController.positionContent()\r\n    },\r\n    _isAllWindowCovered: function() {\r\n        return this._positionController.isAllWindowCoveredByWrapper() && this.option(\"shading\")\r\n    },\r\n    _toggleSafariScrolling: function() {\r\n        var visible = this.option(\"visible\");\r\n        var $body = $(domAdapter.getBody());\r\n        var isIosSafari = \"ios\" === devices.real().platform && browser.safari;\r\n        var isAllWindowCovered = this._isAllWindowCovered();\r\n        var isScrollingPrevented = $body.hasClass(PREVENT_SAFARI_SCROLLING_CLASS);\r\n        var shouldPreventScrolling = !isScrollingPrevented && visible && isAllWindowCovered;\r\n        var shouldEnableScrolling = isScrollingPrevented && (!visible || !isAllWindowCovered || this._disposed);\r\n        if (isIosSafari) {\r\n            if (shouldEnableScrolling) {\r\n                $body.removeClass(PREVENT_SAFARI_SCROLLING_CLASS);\r\n                window.scrollTo(0, this._cachedBodyScrollTop);\r\n                this._cachedBodyScrollTop = void 0\r\n            } else if (shouldPreventScrolling) {\r\n                this._cachedBodyScrollTop = window.pageYOffset;\r\n                $body.addClass(PREVENT_SAFARI_SCROLLING_CLASS)\r\n            }\r\n        }\r\n    },\r\n    _renderWrapper: function() {\r\n        this._positionController.styleWrapperPosition();\r\n        this._renderWrapperDimensions();\r\n        this._positionController.positionWrapper()\r\n    },\r\n    _renderWrapperDimensions: function() {\r\n        var wrapperWidth;\r\n        var wrapperHeight;\r\n        var $container = this._positionController._$wrapperCoveredElement;\r\n        if (!$container) {\r\n            return\r\n        }\r\n        var isWindow = this._positionController.isAllWindowCoveredByWrapper();\r\n        var documentElement = domAdapter.getDocumentElement();\r\n        wrapperWidth = isWindow ? documentElement.clientWidth : getOuterWidth($container), wrapperHeight = isWindow ? window.innerHeight : getOuterHeight($container);\r\n        this._$wrapper.css({\r\n            width: wrapperWidth,\r\n            height: wrapperHeight\r\n        })\r\n    },\r\n    _renderDimensions: function() {\r\n        var content = this._$content.get(0);\r\n        this._$content.css({\r\n            minWidth: this._getOptionValue(\"minWidth\", content),\r\n            maxWidth: this._getOptionValue(\"maxWidth\", content),\r\n            minHeight: this._getOptionValue(\"minHeight\", content),\r\n            maxHeight: this._getOptionValue(\"maxHeight\", content),\r\n            width: this._getOptionValue(\"width\", content),\r\n            height: this._getOptionValue(\"height\", content)\r\n        })\r\n    },\r\n    _focusTarget: function() {\r\n        return this._$content\r\n    },\r\n    _attachKeyboardEvents: function() {\r\n        this._keyboardListenerId = keyboard.on(this._$content, null, opts => this._keyboardHandler(opts))\r\n    },\r\n    _keyboardHandler: function(options) {\r\n        var e = options.originalEvent;\r\n        var $target = $(e.target);\r\n        if ($target.is(this._$content) || !this.option(\"ignoreChildEvents\")) {\r\n            this.callBase(...arguments)\r\n        }\r\n    },\r\n    _isVisible: function() {\r\n        return this.option(\"visible\")\r\n    },\r\n    _visibilityChanged: function(visible) {\r\n        if (visible) {\r\n            if (this.option(\"visible\")) {\r\n                this._renderVisibilityAnimate(visible)\r\n            }\r\n        } else {\r\n            this._renderVisibilityAnimate(visible)\r\n        }\r\n    },\r\n    _dimensionChanged: function() {\r\n        this._renderGeometry({\r\n            isDimensionChange: true\r\n        })\r\n    },\r\n    _clean: function() {\r\n        if (!this._contentAlreadyRendered) {\r\n            this.$content().empty()\r\n        }\r\n        this._renderVisibility(false);\r\n        this._stopShowTimer();\r\n        this._observeContentResize(false);\r\n        this._cleanFocusState()\r\n    },\r\n    _stopShowTimer() {\r\n        if (this._asyncShowTimeout) {\r\n            clearTimeout(this._asyncShowTimeout)\r\n        }\r\n        this._asyncShowTimeout = null\r\n    },\r\n    _dispose: function() {\r\n        fx.stop(this._$content, false);\r\n        clearTimeout(this._deferShowTimer);\r\n        this._toggleViewPortSubscription(false);\r\n        this._toggleSubscriptions(false);\r\n        this._updateZIndexStackPosition(false);\r\n        this._toggleTabTerminator(false);\r\n        this._actions = null;\r\n        this._parentsScrollSubscriptionInfo = null;\r\n        this.callBase();\r\n        this._toggleSafariScrolling();\r\n        this.option(\"visible\") && zIndexPool.remove(this._zIndex);\r\n        this._$wrapper.remove();\r\n        this._$content.remove()\r\n    },\r\n    _toggleRTLDirection: function(rtl) {\r\n        this._$content.toggleClass(RTL_DIRECTION_CLASS, rtl)\r\n    },\r\n    _optionChanged: function(args) {\r\n        var _this$_resizable;\r\n        var value = args.value;\r\n        if (inArray(args.name, ACTIONS) > -1) {\r\n            this._initActions();\r\n            return\r\n        }\r\n        switch (args.name) {\r\n            case \"dragEnabled\":\r\n                this._renderDrag();\r\n                this._renderGeometry();\r\n                break;\r\n            case \"resizeEnabled\":\r\n                this._renderResize();\r\n                this._renderGeometry();\r\n                break;\r\n            case \"shading\":\r\n                this._toggleShading(this.option(\"visible\"));\r\n                this._toggleSafariScrolling();\r\n                break;\r\n            case \"shadingColor\":\r\n                this._toggleShading(this.option(\"visible\"));\r\n                break;\r\n            case \"width\":\r\n            case \"height\":\r\n                this._renderGeometry();\r\n                null === (_this$_resizable = this._resizable) || void 0 === _this$_resizable ? void 0 : _this$_resizable.option(args.name, args.value);\r\n                break;\r\n            case \"minWidth\":\r\n            case \"maxWidth\":\r\n            case \"minHeight\":\r\n            case \"maxHeight\":\r\n                this._renderGeometry();\r\n                break;\r\n            case \"position\":\r\n                this._positionController.updatePosition(this.option(\"position\"));\r\n                this._positionController.restorePositionOnNextRender(true);\r\n                this._renderGeometry();\r\n                this._toggleSafariScrolling();\r\n                break;\r\n            case \"visible\":\r\n                this._renderVisibilityAnimate(value).done(() => {\r\n                    if (!this._animateDeferred) {\r\n                        return\r\n                    }\r\n                    this._animateDeferred.resolveWith(this)\r\n                });\r\n                break;\r\n            case \"target\":\r\n                this._positionController.updateTarget(value);\r\n                this._setAnimationTarget(value);\r\n                this._invalidate();\r\n                break;\r\n            case \"container\":\r\n                this._positionController.updateContainer(value);\r\n                this._invalidate();\r\n                this._toggleSafariScrolling();\r\n                if (this.option(\"resizeEnabled\")) {\r\n                    var _this$_resizable2;\r\n                    null === (_this$_resizable2 = this._resizable) || void 0 === _this$_resizable2 ? void 0 : _this$_resizable2.option(\"area\", this._positionController.$dragResizeContainer)\r\n                }\r\n                break;\r\n            case \"innerOverlay\":\r\n                this._initInnerOverlayClass();\r\n                break;\r\n            case \"deferRendering\":\r\n            case \"contentTemplate\":\r\n                this._contentAlreadyRendered = false;\r\n                this._clean();\r\n                this._invalidate();\r\n                break;\r\n            case \"hideTopOverlayHandler\":\r\n                this._toggleHideTopOverlayCallback(false);\r\n                this._initHideTopOverlayHandler(args.value);\r\n                this._toggleHideTopOverlayCallback(this.option(\"visible\"));\r\n                break;\r\n            case \"hideOnParentScroll\":\r\n                this._toggleHideOnParentsScrollSubscription(this.option(\"visible\"));\r\n                break;\r\n            case \"closeOnOutsideClick\":\r\n            case \"propagateOutsideClick\":\r\n                break;\r\n            case \"animation\":\r\n                this._updateResizeCallbackSkipCondition();\r\n                break;\r\n            case \"rtlEnabled\":\r\n                this._contentAlreadyRendered = false;\r\n                this.callBase(args);\r\n                break;\r\n            case \"_fixWrapperPosition\":\r\n                this._positionController.fixWrapperPosition = value;\r\n                break;\r\n            case \"wrapperAttr\":\r\n                this._renderWrapperAttributes();\r\n                break;\r\n            case \"dragAndResizeArea\":\r\n                this._positionController.dragAndResizeArea = value;\r\n                if (this.option(\"resizeEnabled\")) {\r\n                    this._resizable.option(\"area\", this._positionController.$dragResizeContainer)\r\n                }\r\n                this._positionController.positionContent();\r\n                break;\r\n            case \"dragOutsideBoundary\":\r\n                this._positionController.dragOutsideBoundary = value;\r\n                if (this.option(\"resizeEnabled\")) {\r\n                    this._resizable.option(\"area\", this._positionController.$dragResizeContainer)\r\n                }\r\n                break;\r\n            case \"outsideDragFactor\":\r\n                this._positionController.outsideDragFactor = value;\r\n                break;\r\n            case \"restorePosition\":\r\n                this._positionController.restorePosition = args.value;\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    },\r\n    toggle: function(showing) {\r\n        showing = void 0 === showing ? !this.option(\"visible\") : showing;\r\n        var result = new Deferred;\r\n        if (showing === this.option(\"visible\")) {\r\n            return result.resolveWith(this, [showing]).promise()\r\n        }\r\n        var animateDeferred = new Deferred;\r\n        this._animateDeferred = animateDeferred;\r\n        this.option(\"visible\", showing);\r\n        animateDeferred.promise().done(() => {\r\n            delete this._animateDeferred;\r\n            result.resolveWith(this, [this.option(\"visible\")])\r\n        });\r\n        return result.promise()\r\n    },\r\n    $content: function() {\r\n        return this._$content\r\n    },\r\n    show: function() {\r\n        return this.toggle(true)\r\n    },\r\n    hide: function() {\r\n        return this.toggle(false)\r\n    },\r\n    content: function() {\r\n        return getPublicElement(this._$content)\r\n    },\r\n    repaint: function() {\r\n        if (this._contentAlreadyRendered) {\r\n            this._positionController.restorePositionOnNextRender(true);\r\n            this._renderGeometry({\r\n                forceStopAnimation: true\r\n            });\r\n            triggerResizeEvent(this._$content)\r\n        } else {\r\n            this.callBase()\r\n        }\r\n    }\r\n});\r\nOverlay.baseZIndex = zIndex => zIndexPool.base(zIndex);\r\nregisterComponent(\"dxOverlay\", Overlay);\r\nexport default Overlay;\r\n"]},"metadata":{},"sourceType":"module"}